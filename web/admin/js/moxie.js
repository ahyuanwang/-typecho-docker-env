var MXI_DEBUG=!0;!function(b){function a(){var c={};return function(){(function(g,f){var i={};function m(q,o){var d,s=[];for(var p=0;p<q.length;++p){d=i[q[p]]||k(q[p]);if(!d){throw"module definition dependecy not found: "+q[p]}s.push(d)}o.apply(null,s)}function j(o,n,d){if(typeof o!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(n===f){throw"invalid module definition, dependencies must be specified"}if(d===f){throw"invalid module definition, definition function must be specified"}m(n,function(){i[o]=d.apply(null,arguments)})}function l(d){return !!i[d]}function k(p){var o=g;var d=p.split(/[.\/]/);for(var q=0;q<d.length;++q){if(!o[d[q]]){return}o=o[d[q]]}return o}function h(s){for(var p=0;p<s.length;p++){var d=g;var v=s[p];var q=v.split(/[.\/]/);for(var u=0;u<q.length-1;++u){if(d[q[u]]===f){d[q[u]]={}}d=d[q[u]]}d[q[q.length-1]]=i[v]}}j("moxie/core/utils/Basic",[],function(){function G(n){var d;if(n===d){return"undefined"}else{if(n===null){return"null"}else{if(n.nodeType){return"node"}}}return{}.toString.call(n).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function F(){return M(false,false,arguments)}function R(){return M(true,false,arguments)}function N(){return M(false,true,arguments)}function K(){return M(true,true,arguments)}function H(d){switch(G(d)){case"array":return M(false,true,[[],d]);case"object":return M(false,true,[{},d]);default:return d}}function C(d){switch(G(d)){case"array":return Array.prototype.slice.call(d);case"object":return F({},d)}return d}function M(u,p,s){var t;var d=s[0];T(s,function(o,n){if(n>0){T(o,function(w,v){var r=L(G(w),["array","object"])!==-1;if(w===t||u&&d[v]===t){return true}if(r&&p){w=C(w)}if(G(d[v])===G(w)&&r){M(u,p,[d[v],w])}else{d[v]=w}})}});return d}function J(o,p){for(var d in p){if({}.hasOwnProperty.call(p,d)){o[d]=p[d]}}function r(){this.constructor=o;if(MXI_DEBUG){var n=function(u){var s=u.toString().match(/^function\s([^\(\s]+)/);return s?s[1]:false};this.ctorName=n(o)}}r.prototype=p.prototype;o.prototype=new r;o.parent=p.prototype;return o}function T(u,p){var d,w,s,v;if(u){try{d=u.length}catch(u){d=v}if(d===v||typeof d!=="number"){for(w in u){if(u.hasOwnProperty(w)){if(p(u[w],w)===false){return}}}}else{for(s=0;s<d;s++){if(p(u[s],s)===false){return}}}}}function U(n){var d;if(!n||G(n)!=="object"){return true}for(d in n){return false}return true}function Q(s,o){var d=0,u=s.length;if(G(o)!=="function"){o=function(){}}if(!s||!s.length){o()}function p(e){if(G(s[e])==="function"){s[e](function(n){++e<u&&!n?p(e):o(n)})}}p(d)}function S(s,u){var p=0,t=s.length,d=new Array(t);T(s,function(o,n){o(function(v){if(v){return u(v)}var r=[].slice.call(arguments);r.shift();d[n]=r;p++;if(p===t){d.unshift(null);u.apply(this,d)}})})}function L(p,o){if(o){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(o,p)}for(var d=0,r=o.length;d<r;d++){if(o[d]===p){return d}}}return -1}function O(p,o){var d=[];if(G(p)!=="array"){p=[p]}if(G(o)!=="array"){o=[o]}for(var r in p){if(L(p[r],o)===-1){d.push(p[r])}}return d.length?d:false}function I(o,n){var d=[];T(o,function(p){if(L(p,n)!==-1){d.push(p)}});return d.length?d:null}function P(o){var n,d=[];for(n=0;n<o.length;n++){d[n]=o[n]}return d}var B=function(){var d=0;return function(p){var o=(new Date).getTime().toString(32),n;for(n=0;n<5;n++){o+=Math.floor(Math.random()*65535).toString(32)}return(p||"o_")+o+(d++).toString(32)}}();function z(d){if(!d){return d}return String.prototype.trim?String.prototype.trim.call(d):d.toString().replace(/^\s*/,"").replace(/\s*$/,"")}function A(o){if(typeof o!=="string"){return o}var n={t:1099511627776,g:1073741824,m:1048576,k:1024},d;o=/^([0-9\.]+)([tmgk]?)$/.exec(o.toLowerCase().replace(/[^0-9\.tmkg]/g,""));d=o[2];o=+o[1];if(n.hasOwnProperty(d)){o*=n[d]}return Math.floor(o)}function q(d){var o=[].slice.call(arguments,1);return d.replace(/%([a-z])/g,function(r,p){var n=o.shift();switch(p){case"s":return n+"";case"d":return parseInt(n,10);case"f":return parseFloat(n);case"c":return"";default:return n}})}function D(o,n){var d=this;setTimeout(function(){o.call(d)},n||1)}return{guid:B,typeOf:G,extend:F,extendIf:R,extendImmutable:N,extendImmutableIf:K,clone:H,inherit:J,each:T,isEmptyObj:U,inSeries:Q,inParallel:S,inArray:L,arrayDiff:O,arrayIntersect:I,toArray:P,trim:z,sprintf:q,parseSizeStr:A,delay:D}});j("moxie/core/utils/Encode",[],function(){var n=function(p){return unescape(encodeURIComponent(p))};var q=function(p){return decodeURIComponent(escape(p))};var o=function(C,H){if(typeof window.atob==="function"){return H?q(window.atob(C)):window.atob(C)}var z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var w,p,v,F,I,G,y,E,B=0,D=0,x="",A=[];if(!C){return C}C+="";do{F=z.indexOf(C.charAt(B++));I=z.indexOf(C.charAt(B++));G=z.indexOf(C.charAt(B++));y=z.indexOf(C.charAt(B++));E=F<<18|I<<12|G<<6|y;w=E>>16&255;p=E>>8&255;v=E&255;if(G==64){A[D++]=String.fromCharCode(w)}else{if(y==64){A[D++]=String.fromCharCode(w,p)}else{A[D++]=String.fromCharCode(w,p,v)}}}while(B<C.length);x=A.join("");return H?q(x):x};var d=function(E,J){if(J){E=n(E)}if(typeof window.btoa==="function"){return window.btoa(E)}var B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var y,v,x,H,K,I,A,G,D=0,F=0,z="",C=[];if(!E){return E}do{y=E.charCodeAt(D++);v=E.charCodeAt(D++);x=E.charCodeAt(D++);G=y<<16|v<<8|x;H=G>>18&63;K=G>>12&63;I=G>>6&63;A=G&63;C[F++]=B.charAt(H)+B.charAt(K)+B.charAt(I)+B.charAt(A)}while(D<E.length);z=C.join("");var w=E.length%3;return(w?z.slice(0,w-3):z)+"===".slice(w||3)};return{utf8_encode:n,utf8_decode:q,atob:o,btoa:d}});j("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(q){var s=function(P){var M="",G="?",R="function",K="undefined",N="object",Q="major",E="model",J="name",I="type",T="vendor",F="version",D="architecture",L="console",S="mobile",H="tablet";var O={has:function(o,n){return n.toLowerCase().indexOf(o.toLowerCase())!==-1},lowerize:function(n){return n.toLowerCase()}};var C={rgx:function(){for(var W,aa=0,V,y,w,x,Y,ab,Z=arguments;aa<Z.length;aa+=2){var U=Z[aa],X=Z[aa+1];if(typeof W===K){W={};for(w in X){x=X[w];if(typeof x===N){W[x[0]]=P}else{W[x]=P}}}for(V=y=0;V<U.length;V++){Y=U[V].exec(this.getUA());if(!!Y){for(w=0;w<X.length;w++){ab=Y[++y];x=X[w];if(typeof x===N&&x.length>0){if(x.length==2){if(typeof x[1]==R){W[x[0]]=x[1].call(this,ab)}else{W[x[0]]=x[1]}}else{if(x.length==3){if(typeof x[1]===R&&!(x[1].exec&&x[1].test)){W[x[0]]=ab?x[1].call(this,ab,x[2]):P}else{W[x[0]]=ab?ab.replace(x[1],x[2]):P}}else{if(x.length==4){W[x[0]]=ab?x[3].call(this,ab.replace(x[1],x[2])):P}}}}else{W[x]=ab?ab:P}}break}}if(!!Y){break}}return W},str:function(w,r){for(var o in r){if(typeof r[o]===N&&r[o].length>0){for(var x=0;x<r[o].length;x++){if(O.has(r[o][x],w)){return o===G?P:o}}}else{if(O.has(r[o],w)){return o===G?P:o}}}return w}};var A={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}};var B={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[J,F],[/\s(opr)\/([\w\.]+)/i],[[J,"Opera"],F],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[J,F],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[J,"IE"],F],[/(edge)\/((\d+)?[\w\.]+)/i],[J,F],[/(yabrowser)\/([\w\.]+)/i],[[J,"Yandex"],F],[/(comodo_dragon)\/([\w\.]+)/i],[[J,/_/g," "],F],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[J,F],[/(dolfin)\/([\w\.]+)/i],[[J,"Dolphin"],F],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[J,"Chrome"],F],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[F,[J,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[F,[J,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[F,[J,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[F,[J,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[F,J],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[J,[F,C.str,A.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[J,F],[/(navigator|netscape)\/([\w\.-]+)/i],[[J,"Netscape"],F],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[J,F]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[F,[J,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[J,F],[/rv\:([\w\.]+).*(gecko)/i],[F,J]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[J,F],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[J,[F,C.str,A.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[J,"Windows"],[F,C.str,A.os.windows.version]],[/\((bb)(10);/i],[[J,"BlackBerry"],F],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[J,F],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[J,"Symbian"],F],[/\((series40);/i],[J],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[J,"Firefox OS"],F],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[J,F],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[J,"Chromium OS"],F],[/(sunos)\s?([\w\.]+\d)*/i],[[J,"Solaris"],F],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[J,F],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[J,"iOS"],[F,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[J,"Mac OS"],[F,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[J,F]]};var z=function(o){var n=o||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:M);this.getBrowser=function(){return C.rgx.apply(this,B.browser)};this.getEngine=function(){return C.rgx.apply(this,B.engine)};this.getOS=function(){return C.rgx.apply(this,B.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return n};this.setUA=function(r){n=r;return this};this.setUA(n)};return z}();function p(A,D,z){var y=0,w=0,x=0,B={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},E=function(n){n=(""+n).replace(/[_\-+]/g,".");n=n.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return !n.length?[-8]:n.split(".")},C=function(n){return !n?0:isNaN(n)?B[n]||-7:parseInt(n,10)};A=E(A);D=E(D);w=Math.max(A.length,D.length);for(y=0;y<w;y++){if(A[y]==D[y]){continue}A[y]=C(A[y]);D[y]=C(D[y]);if(A[y]<D[y]){x=-1;break}else{if(A[y]>D[y]){x=1;break}}}if(!z){return x}switch(z){case">":case"gt":return x>0;case">=":case"ge":return x>=0;case"<=":case"le":return x<=0;case"==":case"=":case"eq":return x===0;case"<>":case"!=":case"ne":return x!==0;case"":case"<":case"lt":return x<0;default:return null}}var d=function(){var e={access_global_ns:function(){return !!window.moxie},define_property:function(){return false}(),create_canvas:function(){var o=document.createElement("canvas");var n=!!(o.getContext&&o.getContext("2d"));e.create_canvas=n;return n},return_response_type:function(o){try{if(q.inArray(o,["","text","document"])!==-1){return true}else{if(window.XMLHttpRequest){var n=new XMLHttpRequest;n.open("get","/");if("responseType" in n){n.responseType=o;if(n.responseType!==o){return false}return true}}}}catch(o){}return false},use_blob_uri:function(){var n=window.URL;e.use_blob_uri=n&&"createObjectURL" in n&&"revokeObjectURL" in n&&(u.browser!=="IE"||u.verComp(u.version,"11.0.46",">="));return e.use_blob_uri},use_data_uri:function(){var n=new Image;n.onload=function(){e.use_data_uri=n.width===1&&n.height===1};setTimeout(function(){n.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return false}(),use_data_uri_over32kb:function(){return e.use_data_uri&&(u.browser!=="IE"||u.version>=9)},use_data_uri_of:function(n){return e.use_data_uri&&n<33000||e.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return false}var n=document.createElement("input");n.setAttribute("type","file");return e.use_fileinput=!n.disabled},use_webgl:function(){var r=document.createElement("canvas");var o=null,n;try{o=r.getContext("webgl")||r.getContext("experimental-webgl")}catch(r){}if(!o){o=null}n=!!o;e.use_webgl=n;r=f;return n}};return function(o){var n=[].slice.call(arguments);n.shift();return q.typeOf(e[o])==="function"?e[o].apply(this,n):!!e[o]}}();var v=(new s).getResult();var u={can:d,uaParser:s,browser:v.browser.name,version:v.browser.version,os:v.os.name,osVersion:v.os.version,verComp:p,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};u.OS=u.os;if(MXI_DEBUG){u.debug={runtime:true,events:false};u.log=function(){function r(t){o.appendChild(document.createTextNode(t+"\n"))}if(window&&window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}else{if(document){var o=document.getElementById("moxie-console");if(!o){o=document.createElement("pre");o.id="moxie-console";document.body.appendChild(o)}var n=arguments[0];if(q.typeOf(n)==="string"){n=q.sprintf.apply(this,arguments)}else{if(q.inArray(q.typeOf(n),["object","array"])!==-1){r(n);return}}o.appendChild(document.createTextNode(n+"\n"))}}}}return u});j("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function d(p,o){var n;for(n in p){if(p[n]===o){return n}}return null}return{RuntimeError:function(){var n={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};function o(q,p){this.code=q;this.name=d(n,q);this.message=this.name+(p||": RuntimeError "+this.code)}e.extend(o,n);o.prototype=Error.prototype;return o}(),OperationNotAllowedException:function(){function n(o){this.code=o;this.name="OperationNotAllowedException"}e.extend(n,{NOT_ALLOWED_ERR:1});n.prototype=Error.prototype;return n}(),ImageError:function(){var n={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};function o(p){this.code=p;this.name=d(n,p);this.message=this.name+": ImageError "+this.code}e.extend(o,n);o.prototype=Error.prototype;return o}(),FileException:function(){var n={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};function o(p){this.code=p;this.name=d(n,p);this.message=this.name+": FileException "+this.code}e.extend(o,n);o.prototype=Error.prototype;return o}(),DOMException:function(){var n={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function o(p){this.code=p;this.name=d(n,p);this.message=this.name+": DOMException "+this.code}e.extend(o,n);o.prototype=Error.prototype;return o}(),EventException:function(){function n(o){this.code=o;this.name="EventException"}e.extend(n,{UNSPECIFIED_EVENT_TYPE_ERR:0});n.prototype=Error.prototype;return n}()}});j("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(p){var v=function(n){if(typeof n!=="string"){return n}return document.getElementById(n)};var s=function(r,o){if(!r.className){return false}var n=new RegExp("(^|\\s+)"+o+"(\\s+|$)");return n.test(r.className)};var q=function(o,n){if(!s(o,n)){o.className=!o.className?n:o.className.replace(/\s+$/,"")+" "+n}};var x=function(r,o){if(r.className){var n=new RegExp("(^|\\s+)"+o+"(\\s+|$)");r.className=r.className.replace(n,function(A,z,y){return z===" "&&y===" "?" ":""})}};var u=function(o,n){if(o.currentStyle){return o.currentStyle[n]}else{if(window.getComputedStyle){return window.getComputedStyle(o,null)[n]}}};var w=function(C,F){var B=0,A=0,y,z=document,D,G;C=C;F=F||z.body;function E(J){var H,o,K=0,I=0;if(J){o=J.getBoundingClientRect();H=z.compatMode==="CSS1Compat"?z.documentElement:z.body;K=o.left+H.scrollLeft;I=o.top+H.scrollTop}return{x:K,y:I}}if(C&&C.getBoundingClientRect&&p.browser==="IE"&&(!z.documentMode||z.documentMode<8)){D=E(C);G=E(F);return{x:D.x-G.x,y:D.y-G.y}}y=C;while(y&&y!=F&&y.nodeType){B+=y.offsetLeft||0;A+=y.offsetTop||0;y=y.offsetParent}y=C.parentNode;while(y&&y!=F&&y.nodeType){B-=y.scrollLeft||0;A-=y.scrollTop||0;y=y.parentNode}return{x:B,y:A}};var d=function(n){return{w:n.offsetWidth||n.clientWidth,h:n.offsetHeight||n.clientHeight}};return{get:v,hasClass:s,addClass:q,removeClass:x,getStyle:u,getPos:w,getSize:d}});j("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(n,r,o){var q={};function p(){this.uid=o.guid()}o.extend(p.prototype,{init:function(){if(!this.uid){this.uid=o.guid("uid_")}},addEventListener:function(v,s,d,x){var u=this,w;if(!this.hasOwnProperty("uid")){this.uid=o.guid("uid_")}v=o.trim(v);if(/\s/.test(v)){o.each(v.split(/\s+/),function(t){u.addEventListener(t,s,d,x)});return}v=v.toLowerCase();d=parseInt(d,10)||0;w=q[this.uid]&&q[this.uid][v]||[];w.push({fn:s,priority:d,scope:x||this});if(!q[this.uid]){q[this.uid]={}}q[this.uid][v]=w},hasEventListener:function(s){var d;if(s){s=s.toLowerCase();d=q[this.uid]&&q[this.uid][s]}else{d=q[this.uid]}return d?d:false},removeEventListener:function(v,s){var d=this,w,u;v=v.toLowerCase();if(/\s/.test(v)){o.each(v.split(/\s+/),function(t){d.removeEventListener(t,s)});return}w=q[this.uid]&&q[this.uid][v];if(w){if(s){for(u=w.length-1;u>=0;u--){if(w[u].fn===s){w.splice(u,1);break}}}else{w=[]}if(!w.length){delete q[this.uid][v];if(o.isEmptyObj(q[this.uid])){delete q[this.uid]}}}},removeAllEventListeners:function(){if(q[this.uid]){delete q[this.uid]}},dispatchEvent:function(B){var x,y,w,d,v={},z=true,C;if(o.typeOf(B)!=="string"){d=B;if(o.typeOf(d.type)==="string"){B=d.type;if(d.total!==C&&d.loaded!==C){v.total=d.total;v.loaded=d.loaded}v.async=d.async||false}else{throw new r.EventException(r.EventException.UNSPECIFIED_EVENT_TYPE_ERR)}}if(B.indexOf("::")!==-1){(function(s){x=s[0];B=s[1]})(B.split("::"))}else{x=this.uid}B=B.toLowerCase();y=q[x]&&q[x][B];if(y){y.sort(function(u,s){return s.priority-u.priority});w=[].slice.call(arguments);w.shift();v.type=B;w.unshift(v);if(MXI_DEBUG&&n.debug.events){n.log("%cEvent '%s' fired on %s","color: #999;",v.type,(this.ctorName?this.ctorName+"::":"")+x)}var A=[];o.each(y,function(e){w[0].target=e.scope;if(v.async){A.push(function(s){setTimeout(function(){s(e.fn.apply(e.scope,w)===false)},1)})}else{A.push(function(s){s(e.fn.apply(e.scope,w)===false)})}});if(A.length){o.inSeries(A,function(s){z=!s})}}return z},bindOnce:function(s,d,v,w){var u=this;u.bind.call(this,s,function v(){u.unbind(s,v);return d.apply(this,arguments)},v,w)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(s){var d=this;this.bind(s.join(" "),function(v){var u="on"+v.type.toLowerCase();if(o.typeOf(this[u])==="function"){this[u].apply(this,arguments)}});o.each(s,function(t){t="on"+t.toLowerCase(t);if(o.typeOf(d[t])==="undefined"){d[t]=null}})}});p.instance=new p;return p});j("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(o,t,q,p){var s={},r={};function e(y,B,d,x,w){var v=this,z,C=t.guid(B+"_"),A=w||"browser";y=y||{};r[C]=this;d=t.extend({access_binary:false,access_image_binary:false,display_media:false,do_cors:false,drag_and_drop:false,filter_by_extension:true,resize_image:false,report_upload_progress:false,return_response_headers:false,return_response_type:false,return_status_code:true,send_custom_headers:false,select_file:false,select_folder:false,select_multiple:true,send_binary_string:false,send_browser_cookies:true,send_multipart:true,slice_blob:false,stream_upload:false,summon_file_dialog:false,upload_filesize:true,use_http_method:true},d);if(y.preferred_caps){A=e.getMode(x,y.preferred_caps,A)}if(MXI_DEBUG&&o.debug.runtime){o.log("\tdefault mode: %s",A)}z=function(){var n={};return{exec:function(E,D,u,F){if(z[D]){if(!n[E]){n[E]={context:this,instance:new z[D]}}if(n[E].instance[u]){return n[E].instance[u].apply(this,F)}}},removeInstance:function(u){delete n[u]},removeAllInstances:function(){var u=this;t.each(n,function(E,D){if(t.typeOf(E.instance.destroy)==="function"){E.instance.destroy.call(E.context)}u.removeInstance(D)})}}}();t.extend(this,{initialized:false,uid:C,type:B,mode:e.getMode(x,y.required_caps,A),shimid:C+"_container",clients:0,options:y,can:function(E,D){var u=arguments[2]||d;if(t.typeOf(E)==="string"&&t.typeOf(D)==="undefined"){E=e.parseCaps(E)}if(t.typeOf(E)==="object"){for(var F in E){if(!this.can(F,E[F],u)){return false}}return true}if(t.typeOf(u[E])==="function"){return u[E].call(this,D)}else{return D===u[E]}},getShimContainer:function(){var u,n=q.get(this.shimid);if(!n){u=q.get(this.options.container)||document.body;n=document.createElement("div");n.id=this.shimid;n.className="moxie-shim moxie-shim-"+this.type;t.extend(n.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});u.appendChild(n);u=null}return n},getShim:function(){return z},shimExec:function(D,u){var n=[].slice.call(arguments,2);return v.getShim().exec.call(this,this.uid,D,u,n)},exec:function(D,u){var n=[].slice.call(arguments,2);if(v[D]&&v[D][u]){return v[D][u].apply(this,n)}return v.shimExec.apply(this,arguments)},destroy:function(){if(!v){return}var n=q.get(this.shimid);if(n){n.parentNode.removeChild(n)}if(z){z.removeAllInstances()}this.unbindAll();delete r[this.uid];this.uid=null;C=v=z=n=null}});if(this.mode&&y.required_caps&&!this.can(y.required_caps)){this.mode=false}}e.order="html5,flash,silverlight,html4";e.getRuntime=function(d){return r[d]?r[d]:false};e.addConstructor=function(n,d){d.prototype=p.instance;s[n]=d};e.getConstructor=function(d){return s[d]||null};e.getInfo=function(n){var d=e.getRuntime(n);if(d){return{uid:d.uid,type:d.type,mode:d.mode,can:function(){return d.can.apply(d,arguments)}}}return null};e.parseCaps=function(n){var d={};if(t.typeOf(n)!=="string"){return n||{}}t.each(n.split(","),function(u){d[u]=true});return d};e.can=function(w,u){var d,x=e.getConstructor(w),v;if(x){d=new x({required_caps:u});v=d.mode;d.destroy();return !!v}return false};e.thatCan=function(v,u){var d=(u||e.order).split(/\s*,\s*/);for(var w in d){if(e.can(d[w],v)){return d[w]}}return null};e.getMode=function(w,v,d){var u=null;if(t.typeOf(d)==="undefined"){d="browser"}if(v&&!t.isEmptyObj(w)){t.each(v,function(y,x){if(w.hasOwnProperty(x)){var n=w[x](y);if(typeof n==="string"){n=[n]}if(!u){u=n}else{if(!(u=t.arrayIntersect(u,n))){if(MXI_DEBUG&&o.debug.runtime){o.log("\t\t%s: %s (conflicting mode requested: %s)",x,y,n)}return u=false}}}if(MXI_DEBUG&&o.debug.runtime){o.log("\t\t%s: %s (compatible modes: %s)",x,y,u)}});if(u){return t.inArray(d,u)!==-1?d:u[0]}else{if(u===false){return false}}}return d};e.getGlobalEventTarget=function(){if(/^moxie\./.test(o.global_event_dispatcher)&&!o.can("access_global_ns")){var d=t.guid("moxie_event_target_");window[d]=function(u,n){p.instance.dispatchEvent(u,n)};o.global_event_dispatcher=d}return o.global_event_dispatcher};e.capTrue=function(){return true};e.capFalse=function(){return false};e.capTest=function(d){return function(){return !!d}};return e});j("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(p,n,o,d){return function q(){var e;o.extend(this,{connectRuntime:function(v){var s=this,t;function u(x){var w,r;if(!x.length){s.trigger("RuntimeError",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR));e=null;return}w=x.shift().toLowerCase();r=d.getConstructor(w);if(!r){if(MXI_DEBUG&&p.debug.runtime){p.log("Constructor for '%s' runtime is not available.",w)}u(x);return}if(MXI_DEBUG&&p.debug.runtime){p.log("Trying runtime: %s",w);p.log(v)}e=new r(v);e.bind("Init",function(){e.initialized=true;if(MXI_DEBUG&&p.debug.runtime){p.log("Runtime '%s' initialized",e.type)}setTimeout(function(){e.clients++;s.ruid=e.uid;s.trigger("RuntimeInit",e)},1)});e.bind("Error",function(){if(MXI_DEBUG&&p.debug.runtime){p.log("Runtime '%s' failed to initialize",e.type)}e.destroy();u(x)});e.bind("Exception",function(A,z){var y=z.name+"(#"+z.code+")"+(z.message?", from: "+z.message:"");if(MXI_DEBUG&&p.debug.runtime){p.log("Runtime '%s' has thrown an exception: %s",this.type,y)}s.trigger("RuntimeError",new n.RuntimeError(n.RuntimeError.EXCEPTION_ERR,y))});if(MXI_DEBUG&&p.debug.runtime){p.log("\tselected mode: %s",e.mode)}if(!e.mode){e.trigger("Error");return}e.init()}if(o.typeOf(v)==="string"){t=v}else{if(o.typeOf(v.ruid)==="string"){t=v.ruid}}if(t){e=d.getRuntime(t);if(e){s.ruid=t;e.clients++;return e}else{throw new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR)}}u((v.runtime_order||d.order).split(/\s*,\s*/))},disconnectRuntime:function(){if(e&&--e.clients<=0){e.destroy()}e=null},getRuntime:function(){if(e&&e.uid){return e}return e=null},exec:function(){return e?e.exec.apply(this,arguments):null},can:function(r){return e?e.can(r):false}})}});j("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(q,e,p){var d={};function n(r,o){function s(x,v,u){var y,w=d[this.uid];if(q.typeOf(w)!=="string"||!w.length){return null}y=new n(null,{type:u,size:v-x});y.detach(w.substr(x,y.size));return y}p.call(this);if(r){this.connectRuntime(r)}if(!o){o={}}else{if(q.typeOf(o)==="string"){o={data:o}}}q.extend(this,{uid:o.uid||q.guid("uid_"),ruid:r,size:o.size||0,type:o.type||"",slice:function(w,v,u){if(this.isDetached()){return s.apply(this,arguments)}return this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),w,v,u)},getSource:function(){if(!d[this.uid]){return null}return d[this.uid]},detach:function(v){if(this.ruid){this.getRuntime().exec.call(this,"Blob","destroy");this.disconnectRuntime();this.ruid=null}v=v||"";if(v.substr(0,5)=="data:"){var u=v.indexOf(";base64,");this.type=v.substring(5,u);v=e.atob(v.substring(u+8))}this.size=v.length;d[this.uid]=v},isDetached:function(){return !this.ruid&&q.typeOf(d[this.uid])==="string"},destroy:function(){this.detach();delete d[this.uid]}});if(o.data){this.detach(o.data)}else{d[this.uid]=o}}return n});j("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var d={};return{addI18n:function(n){return e.extend(d,n)},translate:function(n){return d[n]||n},_:function(n){return this.translate(n)},sprintf:function(o){var n=[].slice.call(arguments,1);return o.replace(/%[a-z]/g,function(){var p=n.shift();return e.typeOf(p)!=="undefined"?p:""})}}});j("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(C,q){var x="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe";var p={};var z={};var B=function(D){var s=D.split(/,/),o,E,u;for(o=0;o<s.length;o+=2){u=s[o+1].split(/ /);for(E=0;E<u.length;E++){p[u[E]]=s[o]}z[s[o]]=u}};var w=function(F,D){var u,H,E,G,s=[];for(H=0;H<F.length;H++){u=F[H].extensions.toLowerCase().split(/\s*,\s*/);for(E=0;E<u.length;E++){if(u[E]==="*"){return[]}G=s[u[E]];if(D&&/^\w+$/.test(u[E])){s.push("."+u[E])}else{if(G&&C.inArray(G,s)===-1){s.push(G)}else{if(!G){return[]}}}}}return s};var d=function(o){var r=[];C.each(o,function(s){s=s.toLowerCase();if(s==="*"){r=[];return false}var n=s.match(/^(\w+)\/(\*|\w+)$/);if(n){if(n[2]==="*"){C.each(z,function(D,u){if(new RegExp("^"+n[1]+"/").test(u)){[].push.apply(r,z[u])}})}else{if(z[s]){[].push.apply(r,z[s])}}}});return r};var A=function(r){var o=[],n=[];if(C.typeOf(r)==="string"){r=C.trim(r).split(/\s*,\s*/)}n=d(r);o.push({title:q.translate("Files"),extensions:n.length?n.join(","):"*"});return o};var v=function(o){var n=o&&o.match(/\.([^.]+)$/);if(n){return n[1].toLowerCase()}return""};var y=function(n){return p[v(n)]||""};B(x);return{mimes:p,extensions:z,addMimeType:B,extList2mimes:w,mimes2exts:d,mimes2extList:A,getFileExtension:v,getFileMime:y}});j("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(D,v,p,B,q,y,w,A,x){var z=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];function C(d){if(MXI_DEBUG){v.log("Instantiating FileInput...")}var r,o,n;if(D.inArray(D.typeOf(d),["string","node"])!==-1){d={browse_button:d}}o=B.get(d.browse_button);if(!o){throw new q.DOMException(q.DOMException.NOT_FOUND_ERR)}n={accept:[{title:w.translate("All Files"),extensions:"*"}],multiple:false,required_caps:false,container:o.parentNode||document.body};d=D.extend({},n,d);if(typeof d.required_caps==="string"){d.required_caps=A.parseCaps(d.required_caps)}if(typeof d.accept==="string"){d.accept=p.mimes2extList(d.accept)}r=B.get(d.container);if(!r){r=document.body}if(B.getStyle(r,"position")==="static"){r.style.position="relative"}r=o=null;x.call(this);D.extend(this,{uid:D.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){var e=this;e.bind("RuntimeInit",function(s,t){e.ruid=t.uid;e.shimid=t.shimid;e.bind("Ready",function(){e.trigger("Refresh")},999);e.bind("Refresh",function(){var G,E,u,H,F;u=B.get(d.browse_button);H=B.get(t.shimid);if(u){G=B.getPos(u,B.get(d.container));E=B.getSize(u);F=parseInt(B.getStyle(u,"z-index"),10)||0;if(H){D.extend(H.style,{top:G.y+"px",left:G.x+"px",width:E.w+"px",height:E.h+"px",zIndex:F+1})}}H=u=null});t.exec.call(e,"FileInput","init",d)});e.connectRuntime(D.extend({},d,{required_caps:{select_file:true}}))},getOption:function(s){return d[s]},setOption:function(E,u){if(!d.hasOwnProperty(E)){return}var s=d[E];switch(E){case"accept":if(typeof u==="string"){u=p.mimes2extList(u)}break;case"container":case"required_caps":throw new q.FileException(q.FileException.NO_MODIFICATION_ALLOWED_ERR)}d[E]=u;this.exec("FileInput","setOption",E,u);this.trigger("OptionChanged",E,u,s)},disable:function(u){var s=this.getRuntime();if(s){this.exec("FileInput","disable",D.typeOf(u)==="undefined"?true:u)}},refresh:function(){this.trigger("Refresh")},destroy:function(){var s=this.getRuntime();if(s){s.exec.call(this,"FileInput","destroy");this.disconnectRuntime()}if(D.typeOf(this.files)==="array"){D.each(this.files,function(t){t.destroy()})}this.files=null;this.unbindAll()}});this.handleEventProps(z)}C.prototype=y.instance;return C});j("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(n,q,d){function p(s,r){if(!r){r={}}d.apply(this,arguments);if(!this.type){this.type=q.getFileMime(r.name)}var o;if(r.name){o=r.name.replace(/\\/g,"/");o=o.substr(o.lastIndexOf("/")+1)}else{if(this.type){var u=this.type.split("/")[0];o=n.guid((u!==""?u:"file")+"_");if(q.extensions[this.type]){o+="."+q.extensions[this.type][0]}}}n.extend(this,{name:o||n.guid("file_"),relativePath:"",lastModifiedDate:r.lastModifiedDate||(new Date).toLocaleString()})}p.prototype=d.prototype;return p});j("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(B,d,x,p,z,w,C,q,A){var v=["ready","dragenter","dragleave","drop","error"];function y(o){if(MXI_DEBUG){z.log("Instantiating FileDrop...")}var s=this,r;if(typeof o==="string"){o={drop_zone:o}}r={accept:[{title:B.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:true}};o=typeof o==="object"?p.extend({},r,o):r;o.container=d.get(o.drop_zone)||document.body;if(d.getStyle(o.container,"position")==="static"){o.container.style.position="relative"}if(typeof o.accept==="string"){o.accept=A.mimes2extList(o.accept)}C.call(s);p.extend(s,{uid:p.guid("uid_"),ruid:null,files:null,init:function(){s.bind("RuntimeInit",function(u,n){s.ruid=n.uid;n.exec.call(s,"FileDrop","init",o);s.dispatchEvent("ready")});s.connectRuntime(o)},destroy:function(){var n=this.getRuntime();if(n){n.exec.call(this,"FileDrop","destroy");this.disconnectRuntime()}this.files=null;this.unbindAll()}});this.handleEventProps(v)}y.prototype=q.instance;return y});j("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(w,v,x,q,d,p){var y=["loadstart","progress","load","abort","error","loadend"];function u(){p.call(this);w.extend(this,{uid:w.guid("uid_"),readyState:u.EMPTY,result:null,error:null,readAsBinaryString:function(n){e.call(this,"readAsBinaryString",n)},readAsDataURL:function(n){e.call(this,"readAsDataURL",n)},readAsText:function(n){e.call(this,"readAsText",n)},abort:function(){this.result=null;if(w.inArray(this.readyState,[u.EMPTY,u.DONE])!==-1){return}else{if(this.readyState===u.LOADING){this.readyState=u.DONE}}this.exec("FileReader","abort");this.trigger("abort");this.trigger("loadend")},destroy:function(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(y);this.bind("Error",function(o,n){this.readyState=u.DONE;this.error=n},999);this.bind("Load",function(n){this.readyState=u.DONE},999);function e(s,r){var o=this;this.trigger("loadstart");if(this.readyState===u.LOADING){this.trigger("error",new x.DOMException(x.DOMException.INVALID_STATE_ERR));this.trigger("loadend");return}if(!(r instanceof d)){this.trigger("error",new x.DOMException(x.DOMException.NOT_FOUND_ERR));this.trigger("loadend");return}this.result=null;this.readyState=u.LOADING;if(r.isDetached()){var z=r.getSource();switch(s){case"readAsText":case"readAsBinaryString":this.result=z;break;case"readAsDataURL":this.result="data:"+r.type+";base64,"+v.btoa(z);break}this.readyState=u.DONE;this.trigger("load");this.trigger("loadend")}else{this.connectRuntime(r.ruid);this.exec("FileReader","read",s,r)}}}u.EMPTY=0;u.LOADING=1;u.DONE=2;u.prototype=q.instance;return u});j("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(o){var q=function(z,D){var y=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],w=y.length,d={http:80,https:443},v={},B=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,E=B.exec(z||""),C,x=/^\/\/\w/.test(z);switch(o.typeOf(D)){case"undefined":D=q(document.location.href,false);break;case"string":D=q(D,false);break}while(w--){if(E[w]){v[y[w]]=E[w]}}C=!x&&!v.scheme;if(x||C){v.scheme=D.scheme}if(C){v.host=D.host;v.port=D.port;var A="";if(/^[^\/]/.test(v.path)){A=D.path;if(/\/[^\/]*\.[^\/]*$/.test(A)){A=A.replace(/\/[^\/]+$/,"/")}else{A=A.replace(/\/?$/,"/")}}v.path=A+(v.path||"")}if(!v.port){v.port=d[v.scheme]||80}v.port=parseInt(v.port,10);if(!v.path){v.path="/"}delete v.source;return v};var p=function(s){var r={http:80,https:443},d=typeof s==="object"?s:q(s);return d.scheme+"://"+d.host+(d.port!==r[d.scheme]?":"+d.port:"")+d.path+(d.query?d.query:"")};var n=function(r){function d(s){return[s.scheme,s.host,s.port].join("/")}if(typeof r==="string"){r=q(r)}return d(q())===d(r)};return{parseUrl:q,resolveUrl:p,hasSameOrigin:n}});j("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(p,o,d){function q(){this.uid=p.guid("uid_");o.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}q.prototype=d.instance;return q});j("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(o,d,n){return function(){d.call(this);o.extend(this,{uid:o.guid("uid_"),readAsBinaryString:function(p){return e.call(this,"readAsBinaryString",p)},readAsDataURL:function(p){return e.call(this,"readAsDataURL",p)},readAsText:function(p){return e.call(this,"readAsText",p)}});function e(v,s){if(s.isDetached()){var q=s.getSource();switch(v){case"readAsBinaryString":return q;case"readAsDataURL":return"data:"+s.type+";base64,"+n.btoa(q);case"readAsText":var x="";for(var u=0,w=q.length;u<w;u++){x+=String.fromCharCode(q[u])}return x}}else{var p=this.connectRuntime(s.ruid).exec.call(this,"FileReaderSync","read",v,s);this.disconnectRuntime();return p}}}});j("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(p,d,o){function n(){var e,q=[];d.extend(this,{append:function(s,u){var v=this,r=d.typeOf(u);if(u instanceof o){e={name:s,value:u}}else{if("array"===r){s+="[]";d.each(u,function(t){v.append(s,t)})}else{if("object"===r){d.each(u,function(x,w){v.append(s+"["+w+"]",x)})}else{if("null"===r||"undefined"===r||"number"===r&&isNaN(u)){v.append(s,"false")}else{q.push({name:s,value:u.toString()})}}}}},hasBlob:function(){return !!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(r){d.each(q,function(s){r(s.value,s.name)});if(e){r(e.value,e.name)}},destroy:function(){e=null;q=[]}})}return n});j("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(o,p,K,r,z,s,A,v,y,u,x,E){var q={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};function w(){this.uid=o.guid("uid_")}w.prototype=K.instance;var d=["loadstart","progress","abort","error","load","timeout","loadend"];var J=1,G=2;function I(){var Y=this,V={timeout:0,readyState:I.UNSENT,withCredentials:false,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},ag=true,P,M,X={},ae,ab,U=null,ad=null,W=false,Z=false,T=false,aa=false,L=false,F=false,O,ac,Q=null,H=null,C={},N,af="",ah;o.extend(this,V,{uid:o.guid("uid_"),upload:new w,open:function(ak,ai,R,am,aj){var al;if(!ak||!ai){throw new p.DOMException(p.DOMException.SYNTAX_ERR)}if(/[\u0100-\uffff]/.test(ak)||r.utf8_encode(ak)!==ak){throw new p.DOMException(p.DOMException.SYNTAX_ERR)}if(!!~o.inArray(ak.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])){M=ak.toUpperCase()}if(!!~o.inArray(M,["CONNECT","TRACE","TRACK"])){throw new p.DOMException(p.DOMException.SECURITY_ERR)}ai=r.utf8_encode(ai);al=z.parseUrl(ai);F=z.hasSameOrigin(al);P=z.resolveUrl(ai);if((am||aj)&&!F){throw new p.DOMException(p.DOMException.INVALID_ACCESS_ERR)}ae=am||al.user;ab=aj||al.pass;ag=R||true;if(ag===false&&(B("timeout")||B("withCredentials")||B("responseType")!=="")){throw new p.DOMException(p.DOMException.INVALID_ACCESS_ERR)}W=!ag;Z=false;X={};S.call(this);B("readyState",I.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function(ai,R){var n=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(B("readyState")!==I.OPENED||Z){throw new p.DOMException(p.DOMException.INVALID_STATE_ERR)}if(/[\u0100-\uffff]/.test(ai)||r.utf8_encode(ai)!==ai){throw new p.DOMException(p.DOMException.SYNTAX_ERR)}ai=o.trim(ai).toLowerCase();if(!!~o.inArray(ai,n)||/^(proxy\-|sec\-)/.test(ai)){return false}if(!X[ai]){X[ai]=R}else{X[ai]+=", "+R}return true},hasRequestHeader:function(n){return n&&X[n.toLowerCase()]||false},getAllResponseHeaders:function(){return af||""},getResponseHeader:function(n){n=n.toLowerCase();if(L||!!~o.inArray(n,["set-cookie","set-cookie2"])){return null}if(af&&af!==""){if(!ah){ah={};o.each(af.split(/\r\n/),function(ai){var R=ai.split(/:\s+/);if(R.length===2){R[0]=o.trim(R[0]);ah[R[0].toLowerCase()]={header:R[0],value:o.trim(R[1])}}})}if(ah.hasOwnProperty(n)){return ah[n].header+": "+ah[n].value}}return null},overrideMimeType:function(ai){var R,n;if(!!~o.inArray(B("readyState"),[I.LOADING,I.DONE])){throw new p.DOMException(p.DOMException.INVALID_STATE_ERR)}ai=o.trim(ai.toLowerCase());if(/;/.test(ai)&&(R=ai.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))){ai=R[1];if(R[2]){n=R[2]}}if(!E.mimes[ai]){throw new p.DOMException(p.DOMException.SYNTAX_ERR)}Q=ai;H=n},send:function(ai,R){if(o.typeOf(R)==="string"){C={ruid:R}}else{if(!R){C={}}else{C=R}}if(this.readyState!==I.OPENED||Z){throw new p.DOMException(p.DOMException.INVALID_STATE_ERR)}if(ai instanceof v){C.ruid=ai.ruid;ad=ai.type||"application/octet-stream"}else{if(ai instanceof u){if(ai.hasBlob()){var n=ai.getBlob();C.ruid=n.ruid;ad=n.type||"application/octet-stream"}}else{if(typeof ai==="string"){U="UTF-8";ad="text/plain;charset=UTF-8";ai=r.utf8_encode(ai)}}}if(!this.withCredentials){this.withCredentials=C.required_caps&&C.required_caps.send_browser_cookies&&!F}T=!W&&this.upload.hasEventListener();L=false;aa=!ai;if(!W){Z=true}D.call(this,ai)},abort:function(){L=true;W=false;if(!~o.inArray(B("readyState"),[I.UNSENT,I.OPENED,I.DONE])){B("readyState",I.DONE);Z=false;if(N){N.getRuntime().exec.call(N,"XMLHttpRequest","abort",aa)}else{throw new p.DOMException(p.DOMException.INVALID_STATE_ERR)}aa=true}else{B("readyState",I.UNSENT)}},destroy:function(){if(N){if(o.typeOf(N.destroy)==="function"){N.destroy()}N=null}this.unbindAll();if(this.upload){this.upload.unbindAll();this.upload=null}}});this.handleEventProps(d.concat(["readystatechange"]));this.upload.handleEventProps(d);function B(R,n){if(!V.hasOwnProperty(R)){return}if(arguments.length===1){return x.can("define_property")?V[R]:Y[R]}else{if(x.can("define_property")){V[R]=n}else{Y[R]=n}}}function D(ai){var t=this;O=(new Date).getTime();N=new A;function aj(){if(N){N.destroy();N=null}t.dispatchEvent("loadend");t=null}function R(e){N.bind("LoadStart",function(n){B("readyState",I.LOADING);t.dispatchEvent("readystatechange");t.dispatchEvent(n);if(T){t.upload.dispatchEvent(n)}});N.bind("Progress",function(n){if(B("readyState")!==I.LOADING){B("readyState",I.LOADING);t.dispatchEvent("readystatechange")}t.dispatchEvent(n)});N.bind("UploadProgress",function(n){if(T){t.upload.dispatchEvent({type:"progress",lengthComputable:false,total:n.total,loaded:n.loaded})}});N.bind("Load",function(n){B("readyState",I.DONE);B("status",Number(e.exec.call(N,"XMLHttpRequest","getStatus")||0));B("statusText",q[B("status")]||"");B("response",e.exec.call(N,"XMLHttpRequest","getResponse",B("responseType")));if(!!~o.inArray(B("responseType"),["text",""])){B("responseText",B("response"))}else{if(B("responseType")==="document"){B("responseXML",B("response"))}}af=e.exec.call(N,"XMLHttpRequest","getAllResponseHeaders");t.dispatchEvent("readystatechange");if(B("status")>0){if(T){t.upload.dispatchEvent(n)}t.dispatchEvent(n)}else{L=true;t.dispatchEvent("error")}aj()});N.bind("Abort",function(n){t.dispatchEvent(n);aj()});N.bind("Error",function(n){L=true;B("readyState",I.DONE);t.dispatchEvent("readystatechange");aa=true;t.dispatchEvent(n);aj()});e.exec.call(N,"XMLHttpRequest","send",{url:P,method:M,async:ag,user:ae,password:ab,headers:X,mimeType:ad,encoding:U,responseType:t.responseType,withCredentials:t.withCredentials,options:C},ai)}if(typeof C.required_caps==="string"){C.required_caps=s.parseCaps(C.required_caps)}C.required_caps=o.extend({},C.required_caps,{return_response_type:t.responseType});if(ai instanceof u){C.required_caps.send_multipart=true}if(!o.isEmptyObj(X)){C.required_caps.send_custom_headers=true}if(!F){C.required_caps.do_cors=true}if(C.ruid){R(N.connectRuntime(C))}else{N.bind("RuntimeInit",function(ak,n){R(n)});N.bind("RuntimeError",function(ak,n){t.dispatchEvent("RuntimeError",n)});N.connectRuntime(C)}}function S(){B("responseText","");B("responseXML",null);B("response",null);B("status",0);B("statusText","");O=ac=null}}I.UNSENT=0;I.OPENED=1;I.HEADERS_RECEIVED=2;I.LOADING=3;I.DONE=4;I.prototype=K.instance;return I});j("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(r,n,q,o){function p(){var e,t,y,A,d,z;q.call(this);r.extend(this,{uid:r.guid("uid_"),state:p.IDLE,result:null,transport:function(C,u,s){var D=this;s=r.extend({chunk_size:204798},s);if(e=s.chunk_size%3){s.chunk_size+=3-e}z=s.chunk_size;v.call(this);y=C;A=C.length;if(r.typeOf(s)==="string"||s.ruid){x.call(D,u,this.connectRuntime(s))}else{var B=function(F,E){D.unbind("RuntimeInit",B);x.call(D,u,E)};this.bind("RuntimeInit",B);this.connectRuntime(s)}},abort:function(){var s=this;s.state=p.IDLE;if(t){t.exec.call(s,"Transporter","clear");s.trigger("TransportingAborted")}v.call(s)},destroy:function(){this.unbindAll();t=null;this.disconnectRuntime();v.call(this)}});function v(){A=d=0;y=this.result=null}function x(B,u){var s=this;t=u;s.bind("TransportingProgress",function(C){d=C.loaded;if(d<A&&r.inArray(s.state,[p.IDLE,p.DONE])===-1){w.call(s)}},999);s.bind("TransportingComplete",function(){d=A;s.state=p.DONE;y=null;s.result=t.exec.call(s,"Transporter","getAsBlob",B||"")},999);s.state=p.BUSY;s.trigger("TransportingStarted");w.call(s)}function w(){var B=this,u,s=A-d;if(z>s){z=s}u=n.btoa(y.substr(d,z));t.exec.call(B,"Transporter","receive",u,A)}}p.IDLE=0;p.BUSY=1;p.DONE=2;p.prototype=o.instance;return p});j("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(q,B,y,z,C,G,F,A,o,r,E,w,n){var x=["progress","load","error","resize","embedded"];function D(){F.call(this);q.extend(this,{uid:q.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){d.apply(this,arguments)},resize:function(K){var I=this;var H;var M;var J={x:0,y:0,width:I.width,height:I.height};var L=q.extendIf({width:I.width,height:I.height,type:I.type||"image/jpeg",quality:90,crop:false,fit:true,preserveHeaders:true,resample:"default",multipass:true},K);try{if(!I.size){throw new y.DOMException(y.DOMException.INVALID_STATE_ERR)}if(I.width>D.MAX_RESIZE_WIDTH||I.height>D.MAX_RESIZE_HEIGHT){throw new y.ImageError(y.ImageError.MAX_RESOLUTION_ERR)}H=I.meta&&I.meta.tiff&&I.meta.tiff.Orientation||1;if(q.inArray(H,[5,6,7,8])!==-1){var v=L.width;L.width=L.height;L.height=v}if(L.crop){M=Math.max(L.width/I.width,L.height/I.height);if(K.fit){J.width=Math.min(Math.ceil(L.width/M),I.width);J.height=Math.min(Math.ceil(L.height/M),I.height);M=L.width/J.width}else{J.width=Math.min(L.width,I.width);J.height=Math.min(L.height,I.height);M=1}if(typeof L.crop==="boolean"){L.crop="cc"}switch(L.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":J.x=I.width-J.width;J.y=I.height-J.height;break;case"cb":case"center-bottom":J.x=Math.floor((I.width-J.width)/2);J.y=I.height-J.height;break;case"lb":case"left-bottom":J.x=0;J.y=I.height-J.height;break;case"lt":case"left-top":J.x=0;J.y=0;break;case"ct":case"center-top":J.x=Math.floor((I.width-J.width)/2);J.y=0;break;case"rt":case"right-top":J.x=I.width-J.width;J.y=0;break;case"rc":case"right-center":case"right-middle":J.x=I.width-J.width;J.y=Math.floor((I.height-J.height)/2);break;case"lc":case"left-center":case"left-middle":J.x=0;J.y=Math.floor((I.height-J.height)/2);break;case"cc":case"center-center":case"center-middle":default:J.x=Math.floor((I.width-J.width)/2);J.y=Math.floor((I.height-J.height)/2)}J.x=Math.max(J.x,0);J.y=Math.max(J.y,0)}else{M=Math.min(L.width/I.width,L.height/I.height);if(M>1&&!L.fit){M=1}}this.exec("Image","resize",J,M,L)}catch(K){I.trigger("error",K.code)}},downsize:function(I){var H={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:false,fit:false,preserveHeaders:true,resample:"default"},v;if(typeof I==="object"){v=q.extend(H,I)}else{v=q.extend(H,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]})}this.resize(v)},crop:function(I,H,v){this.downsize(I,H,true,v)},getAsCanvas:function(){if(!o.can("create_canvas")){throw new y.RuntimeError(y.RuntimeError.NOT_SUPPORTED_ERR)}return this.exec("Image","getAsCanvas")},getAsBlob:function(H,v){if(!this.size){throw new y.DOMException(y.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsBlob",H||"image/jpeg",v||90)},getAsDataURL:function(H,v){if(!this.size){throw new y.DOMException(y.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsDataURL",H||"image/jpeg",v||90)},getAsBinaryString:function(I,H){var v=this.getAsDataURL(I,H);return n.atob(v.substring(v.indexOf("base64,")+7))},embed:function(v,L){var K=this,H;var J=q.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:true,resample:"nearest"},L);function I(Q,O){var N=this;if(o.can("create_canvas")){var S=N.getAsCanvas();if(S){v.appendChild(S);S=null;N.destroy();K.trigger("embedded");return}}var P=N.getAsDataURL(Q,O);if(!P){throw new y.ImageError(y.ImageError.WRONG_FORMAT)}if(o.can("use_data_uri_of",P.length)){v.innerHTML='<img src="'+P+'" width="'+N.width+'" height="'+N.height+'" alt="" />';N.destroy();K.trigger("embedded")}else{var R=new A;R.bind("TransportingComplete",function(){H=K.connectRuntime(this.result.ruid);K.bind("Embedded",function(){q.extend(H.getShimContainer().style,{top:"0px",left:"0px",width:N.width+"px",height:N.height+"px"});H=null},999);H.exec.call(K,"ImageView","display",this.result.uid,width,height);N.destroy()});R.transport(n.atob(P.substring(P.indexOf("base64,")+7)),Q,{required_caps:{display_media:true},runtime_order:"flash,silverlight",container:v})}}try{if(!(v=B.get(v))){throw new y.DOMException(y.DOMException.INVALID_NODE_TYPE_ERR)}if(!this.size){throw new y.DOMException(y.DOMException.INVALID_STATE_ERR)}if(this.width>D.MAX_RESIZE_WIDTH||this.height>D.MAX_RESIZE_HEIGHT){}var M=new D;M.bind("Resize",function(){I.call(this,J.type,J.quality)});M.bind("Load",function(){this.downsize(J)});if(this.meta.thumb&&this.meta.thumb.width>=J.width&&this.meta.thumb.height>=J.height){M.load(this.meta.thumb.data)}else{M.clone(this,false)}return M}catch(L){this.trigger("error",L.code)}},destroy:function(){if(this.ruid){this.getRuntime().exec.call(this,"Image","destroy");this.disconnectRuntime()}if(this.meta&&this.meta.thumb){this.meta.thumb.data.destroy()}this.unbindAll()}});this.handleEventProps(x);this.bind("Load Resize",function(){return s.call(this)},999);function s(v){try{if(!v){v=this.exec("Image","getInfo")}this.size=v.size;this.width=v.width;this.height=v.height;this.type=v.type;this.meta=v.meta;if(this.name===""){this.name=v.name}return true}catch(v){this.trigger("error",v.code);return false}}function d(H){var v=q.typeOf(H);try{if(H instanceof D){if(!H.size){throw new y.DOMException(y.DOMException.INVALID_STATE_ERR)}u.apply(this,arguments)}else{if(H instanceof E){if(!~q.inArray(H.type,["image/jpeg","image/png"])){throw new y.ImageError(y.ImageError.WRONG_FORMAT)}p.apply(this,arguments)}else{if(q.inArray(v,["blob","file"])!==-1){d.call(this,new w(null,H),arguments[1])}else{if(v==="string"){if(H.substr(0,5)==="data:"){d.call(this,new E(null,{data:H}),arguments[1])}else{t.apply(this,arguments)}}else{if(v==="node"&&H.nodeName.toLowerCase()==="img"){d.call(this,H.src,arguments[1])}else{throw new y.DOMException(y.DOMException.TYPE_MISMATCH_ERR)}}}}}}catch(H){this.trigger("error",H.code)}}function u(I,H){var v=this.connectRuntime(I.ruid);this.ruid=v.uid;v.exec.call(this,"Image","loadFromImage",I,q.typeOf(H)==="undefined"?true:H)}function p(H,I){var v=this;v.name=H.name||"";function J(K){v.ruid=K.uid;K.exec.call(v,"Image","loadFromBlob",H)}if(H.isDetached()){this.bind("RuntimeInit",function(L,K){J(K)});if(I&&typeof I.required_caps==="string"){I.required_caps=G.parseCaps(I.required_caps)}this.connectRuntime(q.extend({required_caps:{access_image_binary:true,resize_image:true}},I))}else{J(this.connectRuntime(H.ruid))}}function t(I,H){var v=this,J;J=new C;J.open("get",I);J.responseType="blob";J.onprogress=function(K){v.trigger(K)};J.onload=function(){p.call(v,J.response,true)};J.onerror=function(K){v.trigger(K)};J.onloadend=function(){J.destroy()};J.bind("RuntimeError",function(L,K){v.trigger("RuntimeError",K)});J.send(null,H)}}D.MAX_RESIZE_WIDTH=8192;D.MAX_RESIZE_HEIGHT=8192;D.prototype=r.instance;return D});j("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(w,v,n,r){var p="html5",d={};function q(x){var s=this,o=n.capTest,y=n.capTrue;var u=w.extend({access_binary:o(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return s.can("access_binary")&&!!d.Image},display_media:o((r.can("create_canvas")||r.can("use_data_uri_over32kb"))&&l("moxie/image/Image")),do_cors:o(window.XMLHttpRequest&&"withCredentials" in new XMLHttpRequest),drag_and_drop:o(function(){var t=document.createElement("div");return("draggable" in t||"ondragstart" in t&&"ondrop" in t)&&(r.browser!=="IE"||r.verComp(r.version,9,">"))}()),filter_by_extension:o(function(){return !(r.browser==="Chrome"&&r.verComp(r.version,28,"<")||r.browser==="IE"&&r.verComp(r.version,10,"<")||r.browser==="Safari"&&r.verComp(r.version,7,"<")||r.browser==="Firefox"&&r.verComp(r.version,37,"<"))}()),return_response_headers:y,return_response_type:function(t){if(t==="json"&&!!window.JSON){return true}return r.can("return_response_type",t)},return_status_code:y,report_upload_progress:o(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return s.can("access_binary")&&r.can("create_canvas")},select_file:function(){return r.can("use_fileinput")&&window.File},select_folder:function(){return s.can("select_file")&&(r.browser==="Chrome"&&r.verComp(r.version,21,">=")||r.browser==="Firefox"&&r.verComp(r.version,42,">="))},select_multiple:function(){return s.can("select_file")&&!(r.browser==="Safari"&&r.os==="Windows")&&!(r.os==="iOS"&&r.verComp(r.osVersion,"7.0.0",">")&&r.verComp(r.osVersion,"8.0.0","<"))},send_binary_string:o(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:o(window.XMLHttpRequest),send_multipart:function(){return !!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||s.can("send_binary_string")},slice_blob:o(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return s.can("slice_blob")&&s.can("send_multipart")},summon_file_dialog:function(){return s.can("select_file")&&!(r.browser==="Firefox"&&r.verComp(r.version,4,"<")||r.browser==="Opera"&&r.verComp(r.version,12,"<")||r.browser==="IE"&&r.verComp(r.version,10,"<"))},upload_filesize:y,use_http_method:y},arguments[2]);n.call(this,x,arguments[1]||p,u);w.extend(this,{init:function(){this.trigger("Init")},destroy:function(t){return function(){t.call(s);t=s=null}}(this.destroy)});w.extend(this.getShim(),d)}n.addConstructor(p,q);return d});j("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(o,n){function d(){function p(r,q,u){var s;if(window.File.prototype.slice){try{r.slice();return r.slice(q,u)}catch(s){return r.slice(q,u-q)}}else{if(s=window.File.prototype.webkitSlice||window.File.prototype.mozSlice){return s.call(r,q,u)}else{return null}}}this.slice=function(){return new n(this.getRuntime().uid,p.apply(this,arguments))};this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}return o.Blob=d});j("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(n){var q={},o="moxie_"+n.guid();function d(){this.returnValue=false}function x(){this.cancelBubble=true}var w=function(z,u,s,B){var y,A;u=u.toLowerCase();if(z.addEventListener){y=s;z.addEventListener(u,y,false)}else{if(z.attachEvent){y=function(){var r=window.event;if(!r.target){r.target=r.srcElement}r.preventDefault=d;r.stopPropagation=x;s(r)};z.attachEvent("on"+u,y)}}if(!z[o]){z[o]=n.guid()}if(!q.hasOwnProperty(z[o])){q[z[o]]={}}A=q[z[o]];if(!A.hasOwnProperty(u)){A[u]=[]}A[u].push({func:y,orig:s,key:B})};var v=function(u,z,s){var B,y;z=z.toLowerCase();if(u[o]&&q[u[o]]&&q[u[o]][z]){B=q[u[o]][z]}else{return}for(var A=B.length-1;A>=0;A--){if(B[A].orig===s||B[A].key===s){if(u.removeEventListener){u.removeEventListener(z,B[A].func,false)}else{if(u.detachEvent){u.detachEvent("on"+z,B[A].func)}}B[A].orig=null;B[A].func=null;B.splice(A,1);if(s!==y){break}}}if(!B.length){delete q[u[o]][z]}if(n.isEmptyObj(q[u[o]])){delete q[u[o]];try{delete u[o]}catch(z){u[o]=y}}};var p=function(e,r){if(!e||!e[o]){return}n.each(q[e[o]],function(u,s){v(e,s,r)})};return{addEvent:w,removeEvent:v,removeAllEvents:p}});j("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(v,s,w,n,q,u,r){function o(){var d,e;w.extend(this,{init:function(A){var z=this,y=z.getRuntime(),D,p,x,B,E,C;d=A;x=u.extList2mimes(d.accept,y.can("filter_by_extension"));p=y.getShimContainer();p.innerHTML='<input id="'+y.uid+'" type="file" style="font-size:999px;opacity:0;"'+(d.multiple&&y.can("select_multiple")?"multiple":"")+(d.directory&&y.can("select_folder")?"webkitdirectory directory":"")+(x?' accept="'+x.join(",")+'"':"")+" />";D=n.get(y.uid);w.extend(D.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});B=n.get(d.browse_button);e=n.getStyle(B,"z-index")||"auto";if(y.can("summon_file_dialog")){if(n.getStyle(B,"position")==="static"){B.style.position="relative"}q.addEvent(B,"click",function(G){var F=n.get(y.uid);if(F&&!F.disabled){F.click()}G.preventDefault()},z.uid);z.bind("Refresh",function(){E=parseInt(e,10)||1;n.get(d.browse_button).style.zIndex=E;this.getRuntime().getShimContainer().style.zIndex=E-1})}C=y.can("summon_file_dialog")?B:p;q.addEvent(C,"mouseover",function(){z.trigger("mouseenter")},z.uid);q.addEvent(C,"mouseout",function(){z.trigger("mouseleave")},z.uid);q.addEvent(C,"mousedown",function(){z.trigger("mousedown")},z.uid);q.addEvent(n.get(d.container),"mouseup",function(){z.trigger("mouseup")},z.uid);(y.can("summon_file_dialog")?D:B).setAttribute("tabindex",-1);D.onchange=function A(){z.files=[];w.each(this.files,function(H){var G="";if(d.directory){if(H.name=="."){return true}}if(H.webkitRelativePath){G="/"+H.webkitRelativePath.replace(/^\//,"")}H=new s(y.uid,H);H.relativePath=G;z.files.push(H)});if(r.browser!=="IE"&&r.browser!=="IEMobile"){this.value=""}else{var F=this.cloneNode(true);this.parentNode.replaceChild(F,this);F.onchange=A}if(z.files.length){z.trigger("change")}};z.trigger({type:"ready",async:true});p=null},setOption:function(z,x){var p=this.getRuntime();var A=n.get(p.uid);switch(z){case"accept":if(x){var y=x.mimes||u.extList2mimes(x,p.can("filter_by_extension"));A.setAttribute("accept",y.join(","))}else{A.removeAttribute("accept")}break;case"directory":if(x&&p.can("select_folder")){A.setAttribute("directory","");A.setAttribute("webkitdirectory","")}else{A.removeAttribute("directory");A.removeAttribute("webkitdirectory")}break;case"multiple":if(x&&p.can("select_multiple")){A.setAttribute("multiple","")}else{A.removeAttribute("multiple")}}},disable:function(y){var x=this.getRuntime(),p;if(p=n.get(x.uid)){p.disabled=!!y}},destroy:function(){var z=this.getRuntime(),x=z.getShim(),p=z.getShimContainer(),A=d&&n.get(d.container),y=d&&n.get(d.browse_button);if(A){q.removeAllEvents(A,this.uid)}if(y){q.removeAllEvents(y,this.uid);y.style.zIndex=e}if(p){q.removeAllEvents(p,this.uid);p.innerHTML=""}x.removeInstance(this.uid);d=p=A=y=x=null}})}return v.FileInput=o});j("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(u,q,s,o,r,d){function v(){var w=[],p=[],t,D;s.extend(this,{init:function(H){var G=this,n;t=H;D=G.ruid;p=y(t.accept);n=t.container;r.addEvent(n,"dragover",function(I){if(!F(I)){return}I.preventDefault();I.dataTransfer.dropEffect="copy"},G.uid);r.addEvent(n,"drop",function(I){if(!F(I)){return}I.preventDefault();w=[];if(I.dataTransfer.items&&I.dataTransfer.items[0].webkitGetAsEntry){z(I.dataTransfer.items,function(){G.files=w;G.trigger("drop")})}else{s.each(I.dataTransfer.files,function(J){E(J)});G.files=w;G.trigger("drop")}},G.uid);r.addEvent(n,"dragenter",function(I){G.trigger("dragenter")},G.uid);r.addEvent(n,"dragleave",function(I){G.trigger("dragleave")},G.uid)},destroy:function(){r.removeAllEvents(t&&o.get(t.container),this.uid);D=w=p=t=null;this.getRuntime().getShim().removeInstance(this.uid)}});function F(G){if(!G.dataTransfer||!G.dataTransfer.types){return false}var n=s.toArray(G.dataTransfer.types||[]);return s.inArray("Files",n)!==-1||s.inArray("public.file-url",n)!==-1||s.inArray("application/x-moz-file",n)!==-1}function E(H,G){if(C(H)){var n=new q(D,H);n.relativePath=G||"";w.push(n)}}function y(H){var G=[];for(var n=0;n<H.length;n++){[].push.apply(G,H[n].extensions.split(/\s*,\s*/))}return s.inArray("*",G)===-1?G:[]}function C(G){if(!p.length){return true}var n=d.getFileExtension(G.name);return !n||s.inArray(n,p)!==-1}function z(H,G){var n=[];s.each(H,function(J){var I=J.webkitGetAsEntry();if(I){if(I.isFile){E(J.getAsFile(),I.fullPath)}else{n.push(I)}}});if(n.length){B(n,G)}else{G()}}function B(H,G){var n=[];s.each(H,function(e){n.push(function(I){x(e,I)})});s.inSeries(n,function(){G()})}function x(n,e){if(n.isFile){n.file(function(G){E(G,n.fullPath);e()},function(){e()})}else{if(n.isDirectory){A(n,e)}else{e()}}}function A(J,H){var G=[],K=J.createReader();function I(e){K.readEntries(function(n){if(n.length){[].push.apply(G,n);I(e)}else{e()}},e)}I(function(){B(G,H)})}}return u.FileDrop=v});j("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(p,o,d){function n(){var s,e=false;d.extend(this,{read:function(v,u){var r=this;r.result="";s=new window.FileReader;s.addEventListener("progress",function(t){r.trigger(t)});s.addEventListener("load",function(t){r.result=e?q(s.result):s.result;r.trigger(t)});s.addEventListener("error",function(t){r.trigger(t,s.error)});s.addEventListener("loadend",function(t){s=null;r.trigger(t)});if(d.typeOf(s[v])==="function"){e=false;s[v](u.getSource())}else{if(v==="readAsBinaryString"){e=true;s.readAsDataURL(u.getSource())}}},abort:function(){if(s){s.abort()}},destroy:function(){s=null;this.getRuntime().getShim().removeInstance(this.uid)}});function q(r){return o.atob(r.substring(r.indexOf("base64,")+7))}}return p.FileReader=n});j("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(s,u,o,q,n,r,A,y,z){function B(){var w=this,t,p;u.extend(this,{send:function(I,E){var F=this,G=z.browser==="Mozilla"&&z.verComp(z.version,4,">=")&&z.verComp(z.version,7,"<"),D=z.browser==="Android Browser",H=false;p=I.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();t=x();t.open(I.method,I.url,I.async,I.user,I.password);if(E instanceof r){if(E.isDetached()){H=true}E=E.getSource()}else{if(E instanceof A){if(E.hasBlob()){if(E.getBlob().isDetached()){E=v.call(F,E);H=true}else{if((G||D)&&u.typeOf(E.getBlob().getSource())==="blob"&&window.FileReader){e.call(F,I,E);return}}}if(E instanceof A){var C=new window.FormData;E.each(function(K,J){if(K instanceof r){C.append(J,K.getSource())}else{C.append(J,K)}});E=C}}}if(t.upload){if(I.withCredentials){t.withCredentials=true}t.addEventListener("load",function(J){F.trigger(J)});t.addEventListener("error",function(J){F.trigger(J)});t.addEventListener("progress",function(J){F.trigger(J)});t.upload.addEventListener("progress",function(J){F.trigger({type:"UploadProgress",loaded:J.loaded,total:J.total})})}else{t.onreadystatechange=function G(){switch(t.readyState){case 1:break;case 2:break;case 3:var K,J;try{if(q.hasSameOrigin(I.url)){K=t.getResponseHeader("Content-Length")||0}if(t.responseText){J=t.responseText.length}}catch(L){K=J=0}F.trigger({type:"progress",lengthComputable:!!K,total:parseInt(K,10),loaded:J});break;case 4:t.onreadystatechange=function(){};try{if(t.status>=200&&t.status<400){F.trigger("load");break}}catch(L){}F.trigger("error");break}}}if(!u.isEmptyObj(I.headers)){u.each(I.headers,function(K,J){t.setRequestHeader(J,K)})}if(""!==I.responseType&&"responseType" in t){if("json"===I.responseType&&!z.can("return_response_type","json")){t.responseType="text"}else{t.responseType=I.responseType}}if(!H){t.send(E)}else{if(t.sendAsBinary){t.sendAsBinary(E)}else{(function(){var K=new Uint8Array(E.length);for(var J=0;J<E.length;J++){K[J]=E.charCodeAt(J)&255}t.send(K.buffer)})()}}F.trigger("loadstart")},getStatus:function(){try{if(t){return t.status}}catch(C){}return 0},getResponse:function(F){var D=this.getRuntime();try{switch(F){case"blob":var C=new n(D.uid,t.response);var G=t.getResponseHeader("Content-Disposition");if(G){var E=G.match(/filename=([\'\"'])([^\1]+)\1/);if(E){p=E[2]}}C.name=p;if(!C.type){C.type=o.getFileMime(p)}return C;case"json":if(!z.can("return_response_type","json")){return t.status===200&&!!window.JSON?JSON.parse(t.responseText):null}return t.response;case"document":return d(t);default:return t.responseText!==""?t.responseText:null}}catch(F){return null}},getAllResponseHeaders:function(){try{return t.getAllResponseHeaders()}catch(C){}return""},abort:function(){if(t){t.abort()}},destroy:function(){w=p=null;this.getRuntime().getShim().removeInstance(this.uid)}});function e(F,D){var C=this,G,E;G=D.getBlob().getSource();E=new window.FileReader;E.onload=function(){D.append(D.getBlobName(),new r(null,{type:G.type,data:E.result}));w.send.call(C,F,D)};E.readAsBinaryString(G)}function x(){if(window.XMLHttpRequest&&!(z.browser==="IE"&&z.verComp(z.version,8,"<"))){return new window.XMLHttpRequest}else{return function(){var D=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"];for(var C=0;C<D.length;C++){try{return new ActiveXObject(D[C])}catch(D){}}}()}}function d(E){var D=E.responseXML;var C=E.responseText;if(z.browser==="IE"&&C&&D&&!D.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(E.getResponseHeader("Content-Type"))){D=new window.ActiveXObject("Microsoft.XMLDOM");D.async=false;D.validateOnParse=false;D.loadXML(C)}if(D){if(z.browser==="IE"&&D.parseError!==0||!D.documentElement||D.documentElement.tagName==="parsererror"){return null}}return D}function v(F){var D="----moxieboundary"+(new Date).getTime(),H="--",E="\r\n",G="",C=this.getRuntime();if(!C.can("send_binary_string")){throw new y.RuntimeError(y.RuntimeError.NOT_SUPPORTED_ERR)}t.setRequestHeader("Content-Type","multipart/form-data; boundary="+D);F.each(function(J,I){if(J instanceof r){G+=H+D+E+'Content-Disposition: form-data; name="'+I+'"; filename="'+unescape(encodeURIComponent(J.name||"blob"))+'"'+E+"Content-Type: "+(J.type||"application/octet-stream")+E+E+J.getSource()+E}else{G+=H+D+E+'Content-Disposition: form-data; name="'+I+'"'+E+E+unescape(encodeURIComponent(J))+E}});G+=H+D+H+E;return G}}return s.XMLHttpRequest=B});j("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(p){function o(n){if(n instanceof ArrayBuffer){d.apply(this,arguments)}else{q.apply(this,arguments)}}p.extend(o.prototype,{littleEndian:false,read:function(w,u){var s,x,v;if(w+u>this.length()){throw new Error("You are trying to read outside the source boundaries.")}x=this.littleEndian?0:-8*(u-1);for(v=0,s=0;v<u;v++){s|=this.readByteAt(w+v)<<Math.abs(x+v*8)}return s},write:function(w,u,s){var y,v,x="";if(w>this.length()){throw new Error("You are trying to write outside the source boundaries.")}y=this.littleEndian?0:-8*(s-1);for(v=0;v<s;v++){this.writeByteAt(w+v,u>>Math.abs(y+v*8)&255)}},BYTE:function(n){return this.read(n,1)},SHORT:function(n){return this.read(n,2)},LONG:function(n){return this.read(n,4)},SLONG:function(r){var n=this.read(r,4);return n>2147483647?n-4294967296:n},CHAR:function(n){return String.fromCharCode(this.read(n,1))},STRING:function(r,n){return this.asArray("CHAR",r,n).join("")},asArray:function(w,u,s){var x=[];for(var v=0;v<s;v++){x[v]=this[w](u+v)}return x}});function d(e){var n=new DataView(e);p.extend(this,{readByteAt:function(r){return n.getUint8(r)},writeByteAt:function(s,r){n.setUint8(s,r)},SEGMENT:function(u,s,r){switch(arguments.length){case 2:return e.slice(u,u+s);case 1:return e.slice(u);case 3:if(r===null){r=new ArrayBuffer}if(r instanceof ArrayBuffer){var v=new Uint8Array(this.length()-s+r.byteLength);if(u>0){v.set(new Uint8Array(e.slice(0,u)),0)}v.set(new Uint8Array(r),u);v.set(new Uint8Array(e.slice(u+s)),u+r.byteLength);this.clear();e=v.buffer;n=new DataView(e);break}default:return e}},length:function(){return e?e.byteLength:0},clear:function(){n=e=null}})}function q(s){p.extend(this,{readByteAt:function(n){return s.charCodeAt(n)},writeByteAt:function(r,n){e(String.fromCharCode(n),r,1)},SEGMENT:function(u,r,n){switch(arguments.length){case 1:return s.substr(u);case 2:return s.substr(u,r);case 3:e(n!==null?n:"",u,r);break;default:return s}},length:function(){return s?s.length:0},clear:function(){s=null}});function e(u,r,n){n=arguments.length===3?n:s.length-r-1;s=s.substr(0,r)+u+s.substr(n+r)}}return o});j("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,d){return function n(u){var o=[],q,s,p,v=0;q=new e(u);if(q.SHORT(0)!==65496){q.clear();throw new d.ImageError(d.ImageError.WRONG_FORMAT)}s=2;while(s<=q.length()){p=q.SHORT(s);if(p>=65488&&p<=65495){s+=2;continue}if(p===65498||p===65497){break}v=q.SHORT(s+2)+2;if(p>=65505&&p<=65519){o.push({hex:p,name:"APP"+(p&15),start:s,length:v,segment:q.SEGMENT(s,v)})}s+=v}q.clear();return{headers:o,restore:function(x){var w,r,y;y=new e(x);s=y.SHORT(2)==65504?4+y.SHORT(4):2;for(r=0,w=o.length;r<w;r++){y.SEGMENT(s,0,o[r].segment);s+=o[r].length}x=y.SEGMENT();y.clear();return x},strip:function(z){var x,w,A,y;A=new n(z);w=A.headers;A.purge();x=new e(z);y=w.length;while(y--){x.SEGMENT(w[y].start,w[y].length,"")}z=x.SEGMENT();x.clear();return z},get:function(x){var w=[];for(var r=0,y=o.length;r<y;r++){if(o[r].name===x.toUpperCase()){w.push(o[r].segment)}}return w},set:function(z,x){var w=[],B,y,A;if(typeof x==="string"){w.push(x)}else{w=x}for(B=y=0,A=o.length;B<A;B++){if(o[B].name===z.toUpperCase()){o[B].segment=w[y];o[B].length=w[y].length;y++}if(y>=w.length){break}}},purge:function(){this.headers=o=[]}}}});j("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,o,d){function n(y){var B,z,s,x,w,v;o.call(this,y);z={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}};s={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};x={tiffHeader:10};w=x.tiffHeader;B={clear:this.clear};e.extend(this,{read:function(){try{return n.prototype.read.apply(this,arguments)}catch(p){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},write:function(){try{return n.prototype.write.apply(this,arguments)}catch(p){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(p){return this.LONG(p)/this.LONG(p+4)},SRATIONAL:function(p){return this.SLONG(p)/this.SLONG(p+4)},ASCII:function(p){return this.CHAR(p)},TIFF:function(){return v||null},EXIF:function(){var C=null;if(x.exifIFD){try{C=u.call(this,x.exifIFD,z.exif)}catch(C){return null}if(C.ExifVersion&&e.typeOf(C.ExifVersion)==="array"){for(var r=0,p="";r<C.ExifVersion.length;r++){p+=String.fromCharCode(C.ExifVersion[r])}C.ExifVersion=p}}return C},GPS:function(){var p=null;if(x.gpsIFD){try{p=u.call(this,x.gpsIFD,z.gps)}catch(p){return null}if(p.GPSVersionID&&e.typeOf(p.GPSVersionID)==="array"){p.GPSVersionID=p.GPSVersionID.join(".")}}return p},thumb:function(){if(x.IFD1){try{var p=u.call(this,x.IFD1,z.thumb);if("JPEGInterchangeFormat" in p){return this.SEGMENT(x.tiffHeader+p.JPEGInterchangeFormat,p.JPEGInterchangeFormatLength)}}catch(p){}}return null},setExif:function(r,p){if(r!=="PixelXDimension"&&r!=="PixelYDimension"){return false}return A.call(this,"exif",r,p)},clear:function(){B.clear();y=z=s=v=x=B=null}});if(this.SHORT(0)!==65505||this.STRING(4,5).toUpperCase()!=="EXIF\0"){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}this.littleEndian=this.SHORT(w)==18761;if(this.SHORT(w+=2)!==42){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}x.IFD0=x.tiffHeader+this.LONG(w+=2);v=u.call(this,x.IFD0,z.tiff);if("ExifIFDPointer" in v){x.exifIFD=x.tiffHeader+v.ExifIFDPointer;delete v.ExifIFDPointer}if("GPSInfoIFDPointer" in v){x.gpsIFD=x.tiffHeader+v.GPSInfoIFDPointer;delete v.GPSInfoIFDPointer}if(e.isEmptyObj(v)){v=null}var q=this.LONG(x.IFD0+this.SHORT(x.IFD0)*12+2);if(q){x.IFD1=x.tiffHeader+q}function u(J,O){var G=this;var D,p,C,M,P,N,F,L,I=[],K={};var E={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"};var H={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};D=G.SHORT(J);for(p=0;p<D;p++){I=[];F=J+2+p*12;C=O[G.SHORT(F)];if(C===f){continue}M=E[G.SHORT(F+=2)];P=G.LONG(F+=2);N=H[M];if(!N){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}F+=4;if(N*P>4){F=G.LONG(F)+x.tiffHeader}if(F+N*P>=this.length()){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}if(M==="ASCII"){K[C]=e.trim(G.STRING(F,P).replace(/\0$/,""));continue}else{I=G.asArray(M,F,P);L=P==1?I[0]:I;if(s.hasOwnProperty(C)&&typeof L!="object"){K[C]=s[C][L]}else{K[C]=L}}}return K}function A(G,J,F){var D,p,C,H=0;if(typeof J==="string"){var K=z[G.toLowerCase()];for(var I in K){if(K[I]===J){J=I;break}}}D=x[G.toLowerCase()+"IFD"];p=this.SHORT(D);for(var E=0;E<p;E++){C=D+12*E+2;if(this.SHORT(C)==J){H=C+8;break}}if(!H){return false}try{this.write(H,F,4)}catch(G){return false}return true}}n.prototype=o.prototype;return n});j("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(o,n,s,p,r){function q(y){var x,v,A,u;x=new p(y);if(x.SHORT(0)!==65496){throw new n.ImageError(n.ImageError.WRONG_FORMAT)}v=new s(y);try{A=new r(v.get("app1")[0])}catch(y){}u=z.call(this);o.extend(this,{type:"image/jpeg",size:x.length(),width:u&&u.width||0,height:u&&u.height||0,setExif:function(C,B){if(!A){return false}if(o.typeOf(C)==="object"){o.each(C,function(E,D){A.setExif(D,E)})}else{A.setExif(C,B)}v.set("app1",A.SEGMENT())},writeHeaders:function(){if(!arguments.length){return v.restore(y)}return v.restore(arguments[0])},stripHeaders:function(t){return v.strip(t)},purge:function(){w.call(this)}});if(A){this.meta={tiff:A.TIFF(),exif:A.EXIF(),gps:A.GPS(),thumb:d()}}function z(D){var C=0,B,E;if(!D){D=x}while(C<=D.length()){B=D.SHORT(C+=2);if(B>=65472&&B<=65475){C+=5;return{height:D.SHORT(C),width:D.SHORT(C+=2)}}E=D.SHORT(C+=2);C+=E-2}return null}function d(){var D=A.thumb(),C,B;if(D){C=new p(D);B=z(C);C.clear();if(B){B.data=D;return B}}return null}function w(){if(!A||!v||!x){return}A.clear();v.purge();x.clear();u=v=A=x=null}}return q});j("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(n,d,p){function o(y){var z,v,u,A;z=new p(y);(function(){var B=0,s=0,r=[35152,20039,3338,6666];for(s=0;s<r.length;s++,B+=2){if(r[s]!=z.SHORT(B)){throw new n.ImageError(n.ImageError.WRONG_FORMAT)}}})();function x(){var s,r;s=w.call(this,8);if(s.type=="IHDR"){r=s.start;return{width:z.LONG(r),height:z.LONG(r+=4)}}return null}function q(){if(!z){return}z.clear();y=A=v=u=z=null}A=x.call(this);d.extend(this,{type:"image/png",size:z.length(),width:A.width,height:A.height,purge:function(){q.call(this)}});q.call(this);function w(D){var B,s,E,C;B=z.LONG(D);s=z.STRING(D+=4,4);E=D+=4;C=z.LONG(D+B);return{length:B,type:s,start:E,CRC:C}}}return o});j("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(q,e,p,d){return function(o){var n=[p,d],r;r=function(){for(var s=0;s<n.length;s++){try{return new n[s](o)}catch(s){}}throw new e.ImageError(e.ImageError.WRONG_FORMAT)}();q.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(s){return s},stripHeaders:function(s){return s},purge:function(){o=null}});q.extend(this,r);this.purge=function(){r.purge();r=null}}});j("moxie/runtime/html5/image/ResizerCanvas",[],function(){function e(v,s,q){var x=v.width>v.height?"width":"height";var u=Math.round(v[x]*s);var w=false;if(q!=="nearest"&&(s<0.5||s>2)){s=s<0.5?0.5:2;w=true}var p=d(v,s);if(w){return e(p,u/p[x],q)}else{return p}}function d(v,s){var q=v.width;var x=v.height;var u=Math.round(q*s);var w=Math.round(x*s);var p=document.createElement("canvas");p.width=u;p.height=w;p.getContext("2d").drawImage(v,0,0,q,x,0,0,u,w);v=null;return p}return{scale:e}});j("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(o,r,u,p,A,q,v,n,s,z){function d(){var x=this,C,e,w,I,L,K=false,B=true;r.extend(this,{loadFromBlob:function(O){var N=this.getRuntime(),M=arguments.length>1?arguments[1]:true;if(!N.can("access_binary")){throw new u.RuntimeError(u.RuntimeError.NOT_SUPPORTED_ERR)}L=O;if(O.isDetached()){I=O.getSource();D.call(this,I);return}else{t.call(this,O.getSource(),function(P){if(M){I=G(P)}D.call(this,P)})}},loadFromImage:function(N,M){this.meta=N.meta;L=new q(null,{name:N.name,size:N.size,type:N.type});D.call(this,M?I=N.getAsBinaryString():N.getAsDataURL())},getInfo:function(){var N=this.getRuntime(),M;if(!e&&I&&N.can("access_image_binary")){e=new v(I)}M={width:H().width||0,height:H().height||0,type:L.type||s.getFileMime(L.name),size:I&&I.length||L.size||0,name:L.name||"",meta:null};if(B){M.meta=e&&e.meta||this.meta||{};if(M.meta&&M.meta.thumb&&!(M.meta.thumb.data instanceof A)){M.meta.thumb.data=new A(null,{type:"image/jpeg",data:M.meta.thumb.data})}}return M},resize:function(P,N,M){var Q=document.createElement("canvas");Q.width=P.width;Q.height=P.height;Q.getContext("2d").drawImage(H(),P.x,P.y,P.width,P.height,0,0,Q.width,Q.height);w=n.scale(Q,N);B=M.preserveHeaders;if(!B){var O=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;w=E(w,O)}this.width=w.width;this.height=w.height;K=true;this.trigger("Resize")},getAsCanvas:function(){if(!w){w=F()}w.id=this.uid+"_canvas";return w},getAsBlob:function(N,M){if(N!==this.type){K=true;return new q(null,{name:L.name||"",type:N,data:x.getAsDataURL(N,M)})}return new q(null,{name:L.name||"",type:N,data:x.getAsBinaryString(N,M)})},getAsDataURL:function(N){var M=arguments[1]||90;if(!K){return C.src}F();if("image/jpeg"!==N){return w.toDataURL("image/png")}else{try{return w.toDataURL("image/jpeg",M/100)}catch(N){return w.toDataURL("image/jpeg")}}},getAsBinaryString:function(O,N){if(!K){if(!I){I=G(x.getAsDataURL(O,N))}return I}if("image/jpeg"!==O){I=G(x.getAsDataURL(O,N))}else{var M;if(!N){N=90}F();try{M=w.toDataURL("image/jpeg",N/100)}catch(O){M=w.toDataURL("image/jpeg")}I=G(M);if(e){I=e.stripHeaders(I);if(B){if(e.meta&&e.meta.exif){e.setExif({PixelXDimension:this.width,PixelYDimension:this.height})}I=e.writeHeaders(I)}e.purge();e=null}}K=false;return I},destroy:function(){x=null;J.call(this);this.getRuntime().getShim().removeInstance(this.uid)}});function H(){if(!w&&!C){throw new u.ImageError(u.DOMException.INVALID_STATE_ERR)}return w||C}function F(){var M=H();if(M.nodeName.toLowerCase()=="canvas"){return M}w=document.createElement("canvas");w.width=M.width;w.height=M.height;w.getContext("2d").drawImage(M,0,0);return w}function G(M){return p.atob(M.substring(M.indexOf("base64,")+7))}function y(N,M){return"data:"+(M||"")+";base64,"+p.btoa(N)}function D(N){var M=this;C=new Image;C.onerror=function(){J.call(this);M.trigger("error",u.ImageError.WRONG_FORMAT)};C.onload=function(){M.trigger("load")};C.src=N.substr(0,5)=="data:"?N:y(N,L.type)}function t(O,N){var M=this,P;if(window.FileReader){P=new FileReader;P.onload=function(){N.call(M,this.result)};P.onerror=function(){M.trigger("error",u.ImageError.WRONG_FORMAT)};P.readAsDataURL(O)}else{return N.call(this,O.getAsDataURL())}}function E(Q,O){var N=Math.PI/180;var S=document.createElement("canvas");var P=S.getContext("2d");var R=Q.width;var M=Q.height;if(r.inArray(O,[5,6,7,8])>-1){S.width=M;S.height=R}else{S.width=R;S.height=M}switch(O){case 2:P.translate(R,0);P.scale(-1,1);break;case 3:P.translate(R,M);P.rotate(180*N);break;case 4:P.translate(0,M);P.scale(1,-1);break;case 5:P.rotate(90*N);P.scale(1,-1);break;case 6:P.rotate(90*N);P.translate(0,-M);break;case 7:P.rotate(90*N);P.translate(R,-M);P.scale(-1,1);break;case 8:P.rotate(-90*N);P.translate(-R,0);break}P.drawImage(Q,0,0,R,M);return S}function J(){if(e){e.purge();e=null}I=C=w=L=null;K=false}}return o.Image=d});j("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(y,B,z,p,x){var w="flash",A={};function q(){var n;try{n=navigator.plugins["Shockwave Flash"];n=n.description}catch(r){try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(r){n="0.0"}}n=n.match(/\d+/g);return parseFloat(n[0]+"."+n[1])}function v(r){var n=z.get(r);if(n&&n.nodeName=="OBJECT"){if(B.browser==="IE"){n.style.display="none";(function s(){if(n.readyState==4){o(r)}else{setTimeout(s,10)}})()}else{n.parentNode.removeChild(n)}}}function o(s){var r=z.get(s);if(r){for(var n in r){if(typeof r[n]=="function"){r[n]=null}}r.parentNode.removeChild(r)}}function d(t){var e=this,s;t=y.extend({swf_url:B.swf_url},t);x.call(this,t,w,{access_binary:function(n){return n&&e.mode==="browser"},access_image_binary:function(n){return n&&e.mode==="browser"},display_media:x.capTest(l("moxie/image/Image")),do_cors:x.capTrue,drag_and_drop:false,report_upload_progress:function(){return e.mode==="client"},resize_image:x.capTrue,return_response_headers:false,return_response_type:function(n){if(n==="json"&&!!window.JSON){return true}return !y.arrayDiff(n,["","text","document"])||e.mode==="browser"},return_status_code:function(n){return e.mode==="browser"||!y.arrayDiff(n,[200,404])},select_file:x.capTrue,select_multiple:x.capTrue,send_binary_string:function(n){return n&&e.mode==="browser"},send_browser_cookies:function(n){return n&&e.mode==="browser"},send_custom_headers:function(n){return n&&e.mode==="browser"},send_multipart:x.capTrue,slice_blob:function(n){return n&&e.mode==="browser"},stream_upload:function(n){return n&&e.mode==="browser"},summon_file_dialog:false,upload_filesize:function(n){return y.parseSizeStr(n)<=2097152||e.mode==="client"},use_http_method:function(n){return !y.arrayDiff(n,["GET","POST"])}},{access_binary:function(n){return n?"browser":"client"},access_image_binary:function(n){return n?"browser":"client"},report_upload_progress:function(n){return n?"browser":"client"},return_response_type:function(n){return y.arrayDiff(n,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(n){return y.arrayDiff(n,[200,404])?"browser":["client","browser"]},send_binary_string:function(n){return n?"browser":"client"},send_browser_cookies:function(n){return n?"browser":"client"},send_custom_headers:function(n){return n?"browser":"client"},slice_blob:function(n){return n?"browser":"client"},stream_upload:function(n){return n?"client":"browser"},upload_filesize:function(n){return y.parseSizeStr(n)>=2097152?"client":"browser"}},"client");if(q()<11.3){if(MXI_DEBUG&&B.debug.runtime){B.log("\tFlash didn't meet minimal version requirement (11.3).")}this.mode=false}y.extend(this,{getShim:function(){return z.get(this.uid)},shimExec:function(u,r){var n=[].slice.call(arguments,2);return e.getShim().exec(this.uid,u,r,n)},init:function(){var u,r,n;n=this.getShimContainer();y.extend(n.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});u='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+t.swf_url+'" ';if(B.browser==="IE"){u+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}u+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+t.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+x.getGlobalEventTarget()+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(B.browser==="IE"){r=document.createElement("div");n.appendChild(r);r.outerHTML=u;r=n=null}else{n.innerHTML=u}s=setTimeout(function(){if(e&&!e.initialized){e.trigger("Error",new p.RuntimeError(p.RuntimeError.NOT_INIT_ERR));if(MXI_DEBUG&&B.debug.runtime){B.log("\tFlash failed to initialize within a specified period of time (typically 5s).")}}},5000)},destroy:function(n){return function(){v(e.uid);n.call(e);clearTimeout(s);t=s=n=e=null}}(this.destroy)},A)}x.addConstructor(w,d);return A});j("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(n,p){var d={slice:function(u,q,o,v){var s=this.getRuntime();if(q<0){q=Math.max(u.size+q,0)}else{if(q>0){q=Math.min(q,u.size)}}if(o<0){o=Math.max(u.size+o,0)}else{if(o>0){o=Math.min(o,u.size)}}u=s.shimExec.call(this,"Blob","slice",q,o,v||"");if(u){u=new p(s.uid,u)}return u}};return n.Blob=d});j("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(q,p,s,d){var n={init:function(u){var r=this,o=this.getRuntime();var v=s.get(u.browse_button);if(v){v.setAttribute("tabindex",-1);v=null}this.bind("Change",function(){var t=o.shimExec.call(r,"FileInput","getFiles");r.files=[];d.each(t,function(w){r.files.push(new p(o.uid,w))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{accept:u.accept,multiple:u.multiple});this.trigger("ready")}};return q.FileInput=n});j("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(p,n){function o(r,q){switch(q){case"readAsText":return n.atob(r,"utf8");case"readAsBinaryString":return n.atob(r);case"readAsDataURL":return r}return null}var d={read:function(q,r){var s=this;s.result="";if(q==="readAsDataURL"){s.result="data:"+(r.type||"")+";base64,"}s.bind("Progress",function(v,u){if(u){s.result+=o(u,q)}},999);return s.getRuntime().shimExec.call(this,"FileReader","readAsBase64",r.uid)}};return p.FileReader=d});j("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(p,n){function o(r,q){switch(q){case"readAsText":return n.atob(r,"utf8");case"readAsBinaryString":return n.atob(r);case"readAsDataURL":return r}return null}var d={read:function(s,r){var q,u=this.getRuntime();q=u.shimExec.call(this,"FileReaderSync","readAsBase64",r.uid);if(!q){return null}if(s==="readAsDataURL"){q="data:"+(r.type||"")+";base64,"+q}return o(q,s,r.type)}};return p.FileReaderSync=d});j("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(o,p){var d={getAsBlob:function(r){var q=this.getRuntime(),n=q.shimExec.call(this,"Transporter","getAsBlob",r);if(n){return new p(q.uid,n)}return null}};return o.Transporter=d});j("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(x,u,z,p,q,A,w,y,v){var s={send:function(E,D){var C=this,d=C.getRuntime();function B(){E.transport=d.mode;d.shimExec.call(C,"XMLHttpRequest","send",E,D)}function H(o,n){d.shimExec.call(C,"XMLHttpRequest","appendBlob",o,n.uid);D=null;B()}function F(r,o){var n=new y;n.bind("TransportingComplete",function(){o(this.result)});n.transport(r.getSource(),r.type,{ruid:d.uid})}if(!u.isEmptyObj(E.headers)){u.each(E.headers,function(o,n){d.shimExec.call(C,"XMLHttpRequest","setRequestHeader",n,o.toString())})}if(D instanceof w){var I;D.each(function(o,n){if(o instanceof z){I=n}else{d.shimExec.call(C,"XMLHttpRequest","append",n,o)}});if(!D.hasBlob()){D=null;B()}else{var G=D.getBlob();if(G.isDetached()){F(G,function(n){G.destroy();H(I,n)})}else{H(I,G)}}}else{if(D instanceof z){if(D.isDetached()){F(D,function(n){D.destroy();D=n.uid;B()})}else{D=D.uid;B()}}else{B()}}},getResponse:function(r){var o,d,B=this.getRuntime();d=B.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob");if(d){d=new p(B.uid,d);if("blob"===r){return d}try{o=new q;if(!!~u.inArray(r,["","text"])){return o.readAsText(d)}else{if("json"===r&&!!window.JSON){return JSON.parse(o.readAsText(d))}}}finally{d.destroy()}}return null},abort:function(n){var d=this.getRuntime();d.shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}};return x.XMLHttpRequest=s});j("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(s,p,u,q,v){var d={loadFromBlob:function(y){var w=this,o=w.getRuntime();function z(n){o.shimExec.call(w,"Image","loadFromBlob",n.uid);w=o=null}if(y.isDetached()){var x=new u;x.bind("TransportingComplete",function(){z(x.result.getSource())});x.transport(y.getSource(),y.type,{ruid:o.uid})}else{z(y.getSource())}},loadFromImage:function(o){var n=this.getRuntime();return n.shimExec.call(this,"Image","loadFromImage",o.uid)},getInfo:function(){var o=this.getRuntime(),n=o.shimExec.call(this,"Image","getInfo");if(n.meta&&n.meta.thumb&&n.meta.thumb.data&&!(o.meta.thumb.data instanceof q)){n.meta.thumb.data=new q(o.uid,n.meta.thumb.data)}return n},getAsBlob:function(w,r){var o=this.getRuntime(),x=o.shimExec.call(this,"Image","getAsBlob",w,r);if(x){return new q(o.uid,x)}return null},getAsDataURL:function(){var r=this.getRuntime(),o=r.Image.getAsBlob.apply(this,arguments),n;if(!o){return null}n=new v;return n.readAsDataURL(o)}};return s.Image=d});j("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(d,n,q,w,z){var x="silverlight",p={};function v(I){var E=false,F=null,C,A,B,G,J,H=0;try{try{F=new ActiveXObject("AgControl.AgControl");if(F.IsVersionSupported(I)){E=true}F=null}catch(F){var D=navigator.plugins["Silverlight Plug-In"];if(D){C=D.description;if(C==="1.0.30226.2"){C="2.0.30226.2"}A=C.split(".");while(A.length>3){A.pop()}while(A.length<4){A.push(0)}B=I.split(".");while(B.length>4){B.pop()}do{G=parseInt(B[H],10);J=parseInt(A[H],10);H++}while(H<B.length&&G===J);if(G<=J&&!isNaN(G)){E=true}}}}catch(F){E=false}return E}function y(o){var r=this,e;o=d.extend({xap_url:n.xap_url},o);z.call(this,o,x,{access_binary:z.capTrue,access_image_binary:z.capTrue,display_media:z.capTest(l("moxie/image/Image")),do_cors:z.capTrue,drag_and_drop:false,report_upload_progress:z.capTrue,resize_image:z.capTrue,return_response_headers:function(s){return s&&r.mode==="client"},return_response_type:function(s){if(s!=="json"){return true}else{return !!window.JSON}},return_status_code:function(s){return r.mode==="client"||!d.arrayDiff(s,[200,404])},select_file:z.capTrue,select_multiple:z.capTrue,send_binary_string:z.capTrue,send_browser_cookies:function(s){return s&&r.mode==="browser"},send_custom_headers:function(s){return s&&r.mode==="client"},send_multipart:z.capTrue,slice_blob:z.capTrue,stream_upload:true,summon_file_dialog:false,upload_filesize:z.capTrue,use_http_method:function(s){return r.mode==="client"||!d.arrayDiff(s,["GET","POST"])}},{return_response_headers:function(s){return s?"client":"browser"},return_status_code:function(s){return d.arrayDiff(s,[200,404])?"client":["client","browser"]},send_browser_cookies:function(s){return s?"browser":"client"},send_custom_headers:function(s){return s?"client":"browser"},use_http_method:function(s){return d.arrayDiff(s,["GET","POST"])?"client":["client","browser"]}});if(!v("2.0.31005.0")||n.browser==="Opera"){if(MXI_DEBUG&&n.debug.runtime){n.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely).")}this.mode=false}d.extend(this,{getShim:function(){return q.get(this.uid).content.Moxie},shimExec:function(A,u){var s=[].slice.call(arguments,2);return r.getShim().exec(this.uid,A,u,s)},init:function(){var s;s=this.getShimContainer();s.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+o.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+z.getGlobalEventTarget()+'"/></object>';e=setTimeout(function(){if(r&&!r.initialized){r.trigger("Error",new w.RuntimeError(w.RuntimeError.NOT_INIT_ERR));if(MXI_DEBUG&&n.debug.runtime){n.log("Silverlight failed to initialize within a specified period of time (5-10s).")}}},n.OS!=="Windows"?10000:5000)},destroy:function(s){return function(){s.call(r);clearTimeout(e);o=e=s=r=null}}(this.destroy)},p)}z.addConstructor(x,y);return p});j("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(o,n,d){return o.Blob=n.extend({},d)});j("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(u,q,v,d){function p(s){var r="";for(var o=0;o<s.length;o++){r+=(r!==""?"|":"")+s[o].title+" | *."+s[o].extensions.replace(/,/g,";*.")}return r}var n={init:function(s){var r=this,o=this.getRuntime();var w=v.get(s.browse_button);if(w){w.setAttribute("tabindex",-1);w=null}this.bind("Change",function(){var t=o.shimExec.call(r,"FileInput","getFiles");r.files=[];d.each(t,function(x){r.files.push(new q(o.uid,x))})},999);o.shimExec.call(this,"FileInput","init",p(s.accept),s.multiple);this.trigger("ready")},setOption:function(r,o){if(r=="accept"){o=p(o)}this.getRuntime().shimExec.call(this,"FileInput","setOption",r,o)}};return u.FileInput=n});j("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(p,q,o){var d={init:function(){var s=this,r=s.getRuntime(),n;n=r.getShimContainer();o.addEvent(n,"dragover",function(t){t.preventDefault();t.stopPropagation();t.dataTransfer.dropEffect="copy"},s.uid);o.addEvent(n,"dragenter",function(v){v.preventDefault();var u=q.get(r.uid).dragEnter(v);if(u){v.stopPropagation()}},s.uid);o.addEvent(n,"drop",function(v){v.preventDefault();var u=q.get(r.uid).dragDrop(v);if(u){v.stopPropagation()}},s.uid);return r.shimExec.call(this,"FileDrop","init")}};return p.FileDrop=d});j("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(o,n,d){return o.FileReader=n.extend({},d)});j("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(o,n,d){return o.FileReaderSync=n.extend({},d)});j("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(o,n,d){return o.Transporter=n.extend({},d)});j("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(q,o,d,s,p){return q.XMLHttpRequest=o.extend({},d)});j("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(p,o,q,d){return p.Image=o.extend({},d,{getInfo:function(){var v=this.getRuntime(),r=["tiff","exif","gps","thumb"],n={meta:{}},u=v.shimExec.call(this,"Image","getInfo");if(u.meta){o.each(r,function(y){var w=u.meta[y],s,A,x,z;if(w&&w.keys){n.meta[y]={};for(A=0,x=w.keys.length;A<x;A++){s=w.keys[A];z=w[s];if(z){if(/^(\d|[1-9]\d+)$/.test(z)){z=parseInt(z,10)}else{if(/^\d*\.\d+$/.test(z)){z=parseFloat(z)}}n.meta[y][s]=z}}}});if(n.meta&&n.meta.thumb&&n.meta.thumb.data&&!(v.meta.thumb.data instanceof q)){n.meta.thumb.data=new q(v.uid,n.meta.thumb.data)}}n.width=parseInt(u.width,10);n.height=parseInt(u.height,10);n.size=parseInt(u.size,10);n.type=u.type;n.name=u.name;return n},resize:function(s,r,n){this.getRuntime().shimExec.call(this,"Image","resize",s.x,s.y,s.width,s.height,r,n.preserveHeaders,n.resample)}})});j("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(v,w,x,d){var q="html4",n={};function p(s){var r=this,o=x.capTest,u=x.capTrue;x.call(this,s,q,{access_binary:o(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:false,display_media:o((d.can("create_canvas")||d.can("use_data_uri_over32kb"))&&l("moxie/image/Image")),do_cors:false,drag_and_drop:false,filter_by_extension:o(function(){return !(d.browser==="Chrome"&&d.verComp(d.version,28,"<")||d.browser==="IE"&&d.verComp(d.version,10,"<")||d.browser==="Safari"&&d.verComp(d.version,7,"<")||d.browser==="Firefox"&&d.verComp(d.version,37,"<"))}()),resize_image:function(){return n.Image&&r.can("access_binary")&&d.can("create_canvas")},report_upload_progress:false,return_response_headers:false,return_response_type:function(t){if(t==="json"&&!!window.JSON){return true}return !!~v.inArray(t,["text","document",""])},return_status_code:function(t){return !v.arrayDiff(t,[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:false,send_binary_string:false,send_custom_headers:false,send_multipart:true,slice_blob:false,stream_upload:function(){return r.can("select_file")},summon_file_dialog:function(){return r.can("select_file")&&!(d.browser==="Firefox"&&d.verComp(d.version,4,"<")||d.browser==="Opera"&&d.verComp(d.version,12,"<")||d.browser==="IE"&&d.verComp(d.version,10,"<"))},upload_filesize:u,use_http_method:function(t){return !v.arrayDiff(t,["GET","POST"])}});v.extend(this,{init:function(){this.trigger("Init")},destroy:function(t){return function(){t.call(r);t=r=null}}(this.destroy)});v.extend(this.getShim(),n)}x.addConstructor(q,p);return n});j("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(w,x,n,r,u,s,o){function q(){var e,d=[],v,p;function t(){var A=this,z=A.getRuntime(),D,F,C,E,y,B;B=n.guid("uid_");D=z.getShimContainer();if(e){C=r.get(e+"_form");if(C){n.extend(C.style,{top:"100%"});C.firstChild.setAttribute("tabindex",-1)}}E=document.createElement("form");E.setAttribute("id",B+"_form");E.setAttribute("method","post");E.setAttribute("enctype","multipart/form-data");E.setAttribute("encoding","multipart/form-data");n.extend(E.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});y=document.createElement("input");y.setAttribute("id",B);y.setAttribute("type","file");y.setAttribute("accept",d.join(","));if(z.can("summon_file_dialog")){y.setAttribute("tabindex",-1)}n.extend(y.style,{fontSize:"999px",opacity:0});E.appendChild(y);D.appendChild(E);n.extend(y.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});if(o.browser==="IE"&&o.verComp(o.version,10,"<")){n.extend(y.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"})}y.onchange=function(){var G;if(!this.value){return}if(this.files){G=this.files[0]}else{G={name:this.value}}G=new x(z.uid,G);this.onchange=function(){};t.call(A);A.files=[G];y.setAttribute("id",G.uid);E.setAttribute("id",G.uid+"_form");A.trigger("change");y=E=null};if(z.can("summon_file_dialog")){F=r.get(v.browse_button);u.removeEvent(F,"click",A.uid);u.addEvent(F,"click",function(G){if(y&&!y.disabled){y.click()}G.preventDefault()},A.uid)}e=B;D=C=F=null}n.extend(this,{init:function(B){var z=this,A=z.getRuntime(),y;v=B;d=s.extList2mimes(B.accept,A.can("filter_by_extension"));y=A.getShimContainer();(function(){var E,D,C;E=r.get(B.browse_button);p=r.getStyle(E,"z-index")||"auto";if(A.can("summon_file_dialog")){if(r.getStyle(E,"position")==="static"){E.style.position="relative"}z.bind("Refresh",function(){D=parseInt(p,10)||1;r.get(v.browse_button).style.zIndex=D;this.getRuntime().getShimContainer().style.zIndex=D-1})}else{E.setAttribute("tabindex",-1)}C=A.can("summon_file_dialog")?E:y;u.addEvent(C,"mouseover",function(){z.trigger("mouseenter")},z.uid);u.addEvent(C,"mouseout",function(){z.trigger("mouseleave")},z.uid);u.addEvent(C,"mousedown",function(){z.trigger("mousedown")},z.uid);u.addEvent(r.get(B.container),"mouseup",function(){z.trigger("mouseup")},z.uid);E=null})();t.call(this);y=null;z.trigger({type:"ready",async:true})},setOption:function(A,z){var y=this.getRuntime();var B;if(A=="accept"){d=z.mimes||s.extList2mimes(z,y.can("filter_by_extension"))}B=r.get(e);if(B){B.setAttribute("accept",d.join(","))}},disable:function(z){var y;if(y=r.get(e)){y.disabled=!!z}},destroy:function(){var B=this.getRuntime(),z=B.getShim(),y=B.getShimContainer(),C=v&&r.get(v.container),A=v&&r.get(v.browse_button);if(C){u.removeAllEvents(C,this.uid)}if(A){u.removeAllEvents(A,this.uid);A.style.zIndex=p}if(y){u.removeAllEvents(y,this.uid);y.innerHTML=""}z.removeInstance(this.uid);e=d=v=y=C=A=z=null}})}return w.FileInput=q});j("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(n,d){return n.FileReader=d});j("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(r,n,o,d,q,y,s,u){function z(){var e,v,p;function t(A){var x=this,C,E,B,D,w=false;if(!p){return}C=p.id.replace(/_iframe$/,"");E=o.get(C+"_form");if(E){B=E.getElementsByTagName("input");D=B.length;while(D--){switch(B[D].getAttribute("type")){case"hidden":B[D].parentNode.removeChild(B[D]);break;case"file":w=true;break}}B=[];if(!w){E.parentNode.removeChild(E)}E=null}setTimeout(function(){y.removeEvent(p,"load",x.uid);if(p.parentNode){p.parentNode.removeChild(p)}var F=x.getRuntime().getShimContainer();if(!F.children.length){F.parentNode.removeChild(F)}F=p=null;A()},1)}n.extend(this,{send:function(B,C){var A=this,w=A.getRuntime(),x,D,G,E;e=v=null;function F(){var I=w.getShimContainer()||document.body,H=document.createElement("div");H.innerHTML='<iframe id="'+x+'_iframe" name="'+x+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';p=H.firstChild;I.appendChild(p);y.addEvent(p,"load",function(){var J;try{J=p.contentWindow.document||p.contentDocument||window.frames[p.id].document;if(/^4(0[0-9]|1[0-7]|2[2346])\s/.test(J.title)){e=J.title.replace(/^(\d+).*$/,"$1")}else{e=200;v=n.trim(J.body.innerHTML);A.trigger({type:"progress",loaded:v.length,total:v.length});if(E){A.trigger({type:"uploadprogress",loaded:E.size||1025,total:E.size||1025})}}}catch(J){if(d.hasSameOrigin(B.url)){e=404}else{t.call(A,function(){A.trigger("error")});return}}t.call(A,function(){A.trigger("load")})},A.uid)}if(C instanceof u&&C.hasBlob()){E=C.getBlob();x=E.uid;G=o.get(x);D=o.get(x+"_form");if(!D){throw new q.DOMException(q.DOMException.NOT_FOUND_ERR)}}else{x=n.guid("uid_");D=document.createElement("form");D.setAttribute("id",x+"_form");D.setAttribute("method",B.method);D.setAttribute("enctype","multipart/form-data");D.setAttribute("encoding","multipart/form-data");w.getShimContainer().appendChild(D)}D.setAttribute("target",x+"_iframe");if(C instanceof u){C.each(function(J,I){if(J instanceof s){if(G){G.setAttribute("name",I)}}else{var H=document.createElement("input");n.extend(H,{type:"hidden",name:I,value:J});if(G){D.insertBefore(H,G)}else{D.appendChild(H)}}})}D.setAttribute("action",B.url);F();D.submit();A.trigger("loadstart")},getStatus:function(){return e},getResponse:function(w){if("json"===w){if(n.typeOf(v)==="string"&&!!window.JSON){try{return JSON.parse(v.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(w){return null}}}else{if("document"===w){}}return v},abort:function(){var w=this;if(p&&p.contentWindow){if(p.contentWindow.stop){p.contentWindow.stop()}else{if(p.contentWindow.document.execCommand){p.contentWindow.document.execCommand("Stop")}else{p.src="about:blank"}}}t.call(this,function(){w.dispatchEvent("abort")})},destroy:function(){this.getRuntime().getShim().removeInstance(this.uid)}})}return r.XMLHttpRequest=z});j("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(n,d){return n.Image=d});h(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])})(this)}.apply(c,arguments),c.moxie}"function"==typeof define&&define.amd?define("moxie",[],a):"object"==typeof module&&module.exports?module.exports=a():b.moxie=a()}(this||window);