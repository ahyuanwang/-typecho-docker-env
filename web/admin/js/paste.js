(function(){var d,c,e,b,g;function f(a,h){var i;this._container=a,this._target=h,this._container=d(this._container),this._target=d(this._target).addClass("pastable"),this._container.on("paste",(i=this,function(q){var H,A,L,x,D,z,C,w,k,F,J,G,y,E,I,M,B,j,K;if(i.originalEvent=null!==q.originalEvent?q.originalEvent:null,i._paste_event_fired=!0,null!=(null!=(M=q.originalEvent)?M.clipboardData:void 0)){if((A=q.originalEvent.clipboardData).items){for(G=null,i.originalEvent.pastedTypes=[],z=0,k=(E=A.items).length;z<k;z++){(D=E[z]).type.match(/^text\/(plain|rtf|html)/)&&i.originalEvent.pastedTypes.push(D.type)}for(H=C=0,F=(I=A.items).length;C<F;H=++C){if((D=I[H]).type.match(/^image\//)){(y=new FileReader).onload=function(l){return i._handleImage(l.target.result,i.originalEvent,G)};try{y.readAsDataURL(D.getAsFile())}catch(q){}q.preventDefault();break}"text/plain"===D.type&&(0===H&&1<A.items.length&&A.items[1].type.match(/^image\//)&&(j=!0,x=A.items[1].type),D.getAsString(function(l){return j?(G=l,i._target.trigger("pasteText",{text:l,isFilename:!0,fileType:x,originalEvent:i.originalEvent})):i._target.trigger("pasteText",{text:l,originalEvent:i.originalEvent})})),"text/rtf"===D.type&&D.getAsString(function(l){return i._target.trigger("pasteTextRich",{text:l,originalEvent:i.originalEvent})}),"text/html"===D.type&&D.getAsString(function(l){return i._target.trigger("pasteTextHtml",{text:l,originalEvent:i.originalEvent})})}}else{-1!==Array.prototype.indexOf.call(A.types,"text/plain")&&(K=A.getData("Text"),setTimeout(function(){return i._target.trigger("pasteText",{text:K,originalEvent:i.originalEvent})},1)),i._checkImagesInContainer(function(l){return i._handleImage(l,i.originalEvent)})}}if(A=window.clipboardData){if(null!=(M=K=A.getData("Text"))&&M.length){setTimeout(function(){return i._target.trigger("pasteText",{text:K,originalEvent:i.originalEvent}),i._target.trigger("_pasteCheckContainerDone")},1)}else{for(w=0,J=(B=A.files).length;w<J;w++){L=B[w],i._handleImage(URL.createObjectURL(L),i.originalEvent)}i._checkImagesInContainer(function(l){})}}return null}))}(d=window.jQuery).paste=function(a){return"undefined"!=typeof console&&null!==console&&console.log("DEPRECATED: This method is deprecated. Please use $.fn.pastableNonInputable() instead."),c.mountNonInputable(a)._container},d.fn.pastableNonInputable=function(){for(var a,h=0,i=this.length;h<i;h++){(a=this[h])._pastable||d(a).is("textarea, input:text, [contenteditable]")||(c.mountNonInputable(a),a._pastable=!0)}return this},d.fn.pastableTextarea=function(){for(var a,h=0,i=this.length;h<i;h++){(a=this[h])._pastable||d(a).is(":not(textarea, input:text)")||(c.mountTextarea(a),a._pastable=!0)}return this},d.fn.pastableContenteditable=function(){for(var a,h=0,i=this.length;h<i;h++){(a=this[h])._pastable||d(a).is(":not([contenteditable])")||(c.mountContenteditable(a),a._pastable=!0)}return this},b=function(x,q){var k,v,h,p,j,m,y,w;if(null==q&&(q=512),!(m=x.match(/^data\:([^\;]+)\;base64\,(.+)$/))){return null}for((x=m)[0],m=x[1],x=x[2],h=atob(x),v=[],y=0;y<h.length;){for(w=h.slice(y,y+q),p=new Array(w.length),j=0;j<w.length;){p[j]=w.charCodeAt(j),j++}k=new Uint8Array(p),v.push(k),y+=q}return new Blob(v,{type:m})},e=function(){return d(document.createElement("div")).attr("contenteditable",!0).attr("aria-hidden",!0).attr("tabindex",-1).css({width:1,height:1,position:"fixed",left:-100,overflow:"hidden",opacity:1e-17})},g=function(m,q){var u,j,p=void 0,k=void 0,s=void 0,h=m.nodeName.toLowerCase();return"area"===h?(u=(p=m.parentNode).name,!(!m.href||!u||"map"!==p.nodeName.toLowerCase())&&(0<(k=d("img[usemap='#"+u+"']")).length&&k.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(h)?(s=!m.disabled)&&(j=d(m).closest("fieldset")[0])&&(s=!j.disabled):s="a"===h&&m.href||q,(s=s||d(m).is("[contenteditable]"))&&d(m).is(":visible"))},f.prototype._target=null,f.prototype._container=null,f.mountNonInputable=function(a){var h=new f(e().appendTo(a),a);return d(a).on("click",function(i){if(!g(i.target,!1)&&!window.getSelection().toString()){return h._container.focus()}}),h._container.on("focus",function(){return d(a).addClass("pastable-focus")}),h._container.on("blur",function(){return d(a).removeClass("pastable-focus")})},f.mountTextarea=function(k){var l,h,j;return"undefined"!=typeof DataTransfer&&null!==DataTransfer&&DataTransfer.prototype&&null!=(j=Object.getOwnPropertyDescriptor)&&(null!=(j=j.call(Object,DataTransfer.prototype,"items"))&&j.get)?this.mountContenteditable(k):(h=new f(e().insertBefore(k),k),l=!1,d(k).on("keyup",function(a){return 17!==(a=a.keyCode)&&224!==a||(l=!1),null}),d(k).on("keydown",function(a){var i;return 17!==(i=a.keyCode)&&224!==i||(l=!0),null!=a.ctrlKey&&null!=a.metaKey&&(l=a.ctrlKey||a.metaKey),l&&86===a.keyCode&&(h._textarea_focus_stolen=!0,h._container.focus(),h._paste_event_fired=!1,setTimeout(function(){if(!h._paste_event_fired){return d(k).focus(),h._textarea_focus_stolen=!1}},1)),null}),d(k).on("paste",function(){}),d(k).on("focus",function(){if(!h._textarea_focus_stolen){return d(k).addClass("pastable-focus")}}),d(k).on("blur",function(){if(!h._textarea_focus_stolen){return d(k).removeClass("pastable-focus")}}),d(h._target).on("_pasteCheckContainerDone",function(){return d(k).focus(),h._textarea_focus_stolen=!1}),d(h._target).on("pasteText",function(m,p){var q=d(k).prop("selectionStart"),i=d(k).prop("selectionEnd"),o=d(k).val();return d(k).val(""+o.slice(0,q)+p.text+o.slice(i)),d(k)[0].setSelectionRange(q+p.text.length,q+p.text.length),d(k).trigger("change")}))},f.mountContenteditable=function(a){new f(a,a);return d(a).on("focus",function(){return d(a).addClass("pastable-focus")}),d(a).on("blur",function(){return d(a).removeClass("pastable-focus")})},f.prototype._handleImage=function(k,h,l){var j,n,m;return k.match(/^webkit\-fake\-url\:\/\//)?this._target.trigger("pasteImageError",{message:"You are trying to paste an image in Safari, however we are unable to retieve its data."}):(this._target.trigger("pasteImageStart"),(j=new Image).crossOrigin="anonymous",j.onload=(n=this,function(){var a,i,o=document.createElement("canvas");o.width=j.width,o.height=j.height,o.getContext("2d").drawImage(j,0,0,o.width,o.height),i=null;try{i=o.toDataURL("image/png"),a=b(i)}catch(a){}return i&&n._target.trigger("pasteImage",{blob:a,dataURL:i,width:j.width,height:j.height,originalEvent:h,name:l}),n._target.trigger("pasteImageEnd")}),j.onerror=(m=this,function(){return m._target.trigger("pasteImageError",{message:"Failed to get image from: "+k,url:k}),m._target.trigger("pasteImageEnd")}),j.src=k)},f.prototype._checkImagesInContainer=function(h){for(var l,k,p=Math.floor(1000*Math.random()),j=this._container.find("img"),m=0,q=j.length;m<q;m++){(l=j[m])["_paste_marked_"+p]=!0}return setTimeout((k=this,function(){for(var a=k._container.find("img"),i=0,o=a.length;i<o;i++){(l=a[i])["_paste_marked_"+p]||(h(l.src),d(l).remove())}return k._target.trigger("_pasteCheckContainerDone")}),1)},c=f}).call(this);